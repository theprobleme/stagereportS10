\documentclass[12pt]{article}
\usepackage[oddeven,baseline=innovation]{EseoArticle}
\pretitle{%
  \begin{center}
  \LARGE
  \includegraphics[width=6cm]{eseoNone}\\[\bigskipamount]
}
\posttitle{\end{center}}
\usepackage{enumitem}
\usepackage{array}
\usepackage{eurosym}
\usepackage{hyperref}
\usepackage{color}
\usepackage{fancyhdr}
\usepackage{titlesec}
\usepackage{lscape}
\usepackage{amssymb}
\usepackage[acronym,toc,nopostdot]{glossaries}
\usepackage[
    backend=biber,
    style=ieee,
  ]{biblatex}
\usepackage{fancyref}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{etoolbox}

\setlength{\abovecaptionskip}{0pt plus 0pt minus 0pt}
\pagestyle{fancy}

% Import du glossaire
\makeglossaries
\setglossarystyle{listhypergroup}
\loadglsentries{glossery}

% Import bibliography
\addbibresource{bibliography.bib}

% Informations de la page de garde
\title{Rapport de stage S10}
\author{Paul LEFAY}
\date{2021-2022}

\begin{document}

% Footer et Header
\lfoot{Paul LEFAY}
\cfoot{\thepage}
\rfoot{Promotion Meitner - Année 2022}

% Modification des paramètres globaux
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}
\renewcommand{\contentsname}{Table des matières}
\renewcommand{\listfigurename}{}
\renewcommand{\listtablename}{}
\renewcommand{\thebibliography}{}
\renewcommand{\glossarysection}[2][]{}
\renewcommand{\partname}{Partie}
\patchcmd{\thebibliography}{\section*{\refname}}{}{}{}
\defbibheading{bibliography}[\refname]{}

% Modifications pour les espaces de verbatim
\makeatletter
\preto{\@verbatim}{\topsep=0pt \partopsep=0pt }
\makeatother
\AtBeginEnvironment{verbatim}{\setlist[trivlist]{nolistsep}}

% Page de de garde
\maketitle
\thispagestyle{empty}
\begin{center}
	\begin{tabular}{ m{5cm} m{11.5cm} }
	\textbf{TYPE}: & \mbox{\ooalign{$\checkmark$\cr\hidewidth$\square$\hidewidth\cr}}  Stage de fin d'études (Stage ingénieur - S10) \\
   \textbf{ENTREPRISE}:  & Empreinte Digitale \\
   \textbf{DATES}: & Du 31 janvier 2022 au 7 septembre 2022 \\
   \textbf{SUJET MISSION}: & Analyse et réalisation d'audits automatisés de l'infrastructure \\
   \textbf{TUTEUR ENTREPRISE}:  & Valentin Baraise et Yves-Gaël Chény \\
 \end{tabular}
\end{center}

\begin{figure}[!ht]
    \centering
    \includegraphics[scale=0.8]{src/logo_ed.png}
    \label{fig:ed_logo}
\end{figure}

\begin{center}
	\begin{tabular}{ m{5cm} m{11.5cm} }
	\textbf{OPTION}: &  \mbox{\ooalign{$\checkmark$\cr\hidewidth$\square$\hidewidth\cr}} CSS  \\
    \textbf{CONFIDENTIALITÉ}:  & Mon rapport est confidentiel niveau : \mbox{\ooalign{$\checkmark$\cr\hidewidth$\square$\hidewidth\cr}} 0 \\
    \textbf{DOMAINE ENTREPRISE}: & \mbox{\ooalign{$\checkmark$\cr\hidewidth$\square$\hidewidth\cr}} Autres (précisez): Développement d'applications, hébergement web, conformité RGPD, audit d'accessibilité \\
    \textbf{AUTRES POINTS}: &  $\square$ Stage à dominante \textbf{management} \\
                             &  $\square$ Stage à dominante \textbf{recherche} \\
                             & \mbox{\ooalign{$\checkmark$\cr\hidewidth$\square$\hidewidth\cr}} E5e effectuée sous Contrat Pro \\
                             &  \mbox{\ooalign{$\checkmark$\cr\hidewidth$\square$\hidewidth\cr}} Mon tuteur sera présent à ma soutenance \\
                             &  \mbox{\ooalign{$\checkmark$\cr\hidewidth$\square$\hidewidth\cr}} Mon tuteur participera au déjeuner le jour de ma soutenance \\
\end{tabular}
\end{center}

\newpage

\section*{Engagement de non plagiat}
\textit{Je soussigné(e), Paul LEFAY, étudiant à l'\gls{ESEO}, atteste avoir pris connaissance du contenu du Règlement intérieur de l'École et de l'engagement de « non-plagiat ». 
Je déclare m'y conformer dans le cadre de la rédaction de ce document. 
Je déclare sur l'honneur que le contenu du présent mémoire est original et reflète mon travail personnel. 
J'atteste que les citations sont correctement signalées par des guillemets et que les sources de tous les emprunts ponctuels à d'autres auteur(e)s, textuels ou non textuels, sont indiquées. 
Le non-respect de cet engagement m'exposerait à des sanctions dont j'ai bien pris connaissance.}

\textit{Fait à Angers le 11 février 2021.}

% Remerciements %
\newpage
\section*{Remerciements}
Je tiens à remercier Yves-Gaël Chény, Nicolas Gourichon et Valentin Baraise pour l'opportunité qu'ils m'ont donnée en m'acceptant en contrat de professionnalisation. 
L'expérience acquise lors de la période de Projet de Fin d'Etude (\gls{PFE}) est inestimable comparé à celle que j'aurais eue si j'avais travaillé sur un \gls{PFE} scolaire. \\

Je remercie particulièrement Valentin Baraise, mon tuteur, pour son accompagnement durant toute cette année. 
Bien que très occupé, il a toujours pris le temps de m'aider lorsque j'étais bloqué. 
Il a également (malgré lui), pris la peine de réparer les quelques erreurs que j'ai pu commettre. \\

Je remercie également Inès Audouin et Nicolas Gourichon qui m'ont accompagné sur mes premières installations et utilisations d'\gls{Ansible}. 
Ils m'ont apporté de nombreuses connaissances sur le sujet, ce qui fait qu'à ce jour, je suis automome sur l'utilisation des outils \gls{Ansible} et AWX. \\

Enfin, merci à Yves-Gaël Chény et Raphaël Poitevin pour l'aide qu'ils m'ont apportés, notamment sur les aspects réseaux et mail.


% Sommaire %
\newpage
\tableofcontents

% Fiche de synthèse du stage %
\newpage
\section*{Introduction}
Mon sujet de stage S10 porte sur la mise en place de nouveaux outils de sécurité pour améliorer le système d'information d'Empreinte Digitale. 
J'ai principalement travaillé sur des outils d'inventaire des machines et sur le durcissement des systèmes \gls{Linux}. 
En parallèle de ces travaux de sécurité, j'ai mis en place de nouvelles infrastructures ou logiciels pour des clients, amélioré le processus pour les nouveaux arrivants et rédigé de la documentation technique propre aux administrateurs système. \\

Ce stage à eu lieu dans le cadre d'un contrat de professionnalisation chez Empreinte Digitale, située au 11 rue des Noyers à Angers. 
J'y ai effectué mon stage de 7 mois du 30 janvier 2022 au 8 septembre 2022. 
Ce rapport à donc été rendu 2 semaines avant la fin du stage. \\

Ce stage fait suite à un besoin grandissant d'Empreinte Digitale d'améliorer en continu la sécurité de l'infrastructure. 
Étant une entreprise développant des applications web et hébergeant des applications open-source, elle est impactée par la menace croissante des attaques informatiques. \\

Mon rapport s'organise en quatre parties. 
Dans la première, j'exposerai l'environnement et le contexte du stage. 
La seconde partie sera consacrée à la présentation de trois outils techniques régulièrement utilisées et cités dans ce document. 
Dans une troisième partie, j'évoquerai les travaux de sécurité avec les thématiques de sécurité, l'inventaire des machines, le durcissement des systèmes \gls{Linux} et la documentation. 
Je présenterai en quatrième partie les divers travaux d'administrateur système. 
Enfin, je conclurai par un bilan personnel. \\

Ce rapport a été rédigé en \LaTeX à partir du template de M. Woodward. 
Les liens hypertexte, les liens vers des sections ou des acronymes et définition sont interactifs.
Les ressources sont disponibles sur le dépôt GitHub \begin{hilite} \url{https://github.com/theprobleme/stagereportS10} \end{hilite}.

% Abstract %
\newpage
\section*{Abstract}

% 1ère Partie : L'environnement et le contexte du stage %
\newpage
\part{L'environnement et le contexte du stage}
\section{Empreinte Digitale}
\noindent%
\begin{minipage}{.7\textwidth}%
Empreinte Digitale est une \gls{SCOP} d'une cinquantaine de collaborateurs basée sur Angers depuis 29 ans. 
Elle travaille à la réalisation de solutions numériques responsables et sur-mesure.
\end{minipage}%
\hfill
\begin{minipage}{.3\textwidth}%
\begin{center}
    \includegraphics[scale=0.3]{src/logo_ed.png}
\end{center}
\end{minipage}%

\subsection{Activités}
L'activité de l'entreprise se découpe en 5 axes:

\noindent%
\begin{minipage}{.7\textwidth}%

\textbf{Développement sur-mesure}: réalisation de logiciels répondant à un besoin métier.

\textbf{Hébergement en cloud privé}: hébergement Web responsable en \gls{cloud privé} indépendant dans des datacenters en France. 
Les serveurs sont exclusivement gérés avec des technologies libres et open source, garantissant une indépendance vis-à-vis d'entreprises tierces.

\textbf{Accessibilité numérique}: audit de services numériques, formations et accompagnement dans la mise en place de démarche de mise en accessibilité des sites et services.

\textbf{Système d'information archivistique}: suite logicielle Ligeo Archives, un système d'information archivistique. 
Il répond aux besoins de gestion et de valorisation du patrimoine archivistique, tout en garantissant une souplesse d'utilisation, de paramétrage et une ergonomie moderne.

\textbf{Mise en conformité \gls{RGPD}}: évaluation du niveau de conformité \gls{RGPD} avec pilotage de la mise en oeuvre des préconisations essentielles à la mise en conformité au \gls{RGPD}.

\end{minipage}%
\hfill
\begin{minipage}{.3\textwidth}%
\begin{center}
    \includegraphics[scale=0.22]{src/logo_ligeo.png}
\end{center}
\end{minipage}%


\subsection{Structure}

\noindent%
\begin{minipage}{.7\textwidth}%
Juridiquement, une \gls{SCOP} (Société coopérative et participative) est une société coopérative de forme \gls{SA}, \gls{SARL} ou \gls{SAS} dont les salariés sont les associés majoritaires et le pouvoir y est exercé démocratiquement.
Les salariés détiennent au moins 51 \% du capital social et 65 \% des droits de vote. 
Si tous les salariés ne sont pas associés, tous ont vocation à le devenir. 
Chaque salarié associé dispose d’une voix, quel que soit son statut, son ancienneté et le montant du capital investi.
Les informations liées à la vie de l’entreprise circulent en toute transparence et les décisions stratégiques sont l’expression du plus grand nombre. \cite{Scop} \\
\end{minipage}%
\hfill
\begin{minipage}{.3\textwidth}%
\begin{center}
    \includegraphics[scale=0.7]{src/logo_scop.png}
\end{center}
\end{minipage}%

Financièrement, cela signifie qu'Empreinte Digitale fonctionne sur un principe de réserve, avec une répartition d'au moins 25 \% du résultat reversé sous forme de participation pour tous les salariés en fonction de leur ancienneté.

La \gls{SCOP} apporte un avantage dans la pérennisation de l'entreprise et ses emplois avec un modèle attirant pour les futur collaborateurs. 
La transparence et la collaboration est un facteur clé dans l'entretien de l'implication et la motivation des salariés.

Empreinte Digitale à commencé sa transition en \gls{SCOP} à partir de 2018 pour officiellement le devenir en janvier 2020.
\begin{figure}[!ht]
    \centering
    \includegraphics[width=\textwidth]{src/graph_scop.png}
    \caption{Les étapes du passage en \gls{SCOP} d'Empreinte Digitale}
    \label{fig:transition_scop}
\end{figure}


\newpage
La gouvernance se découpe de la manière suivante:
\begin{figure}[!ht]
    \centering
    \includegraphics[width=\textwidth]{src/scheme_scop_ed.png}
    \caption{Schéma de la gouvernance chez Empreinte Digitale}
    \label{fig:gouvernance_ed}
\end{figure}

La gouvernance coopérative est similaire au fonctionnement d'une association loi 1901 avec les membres de l'association et le conseil d'administration. 
Le conseil d'administration a pour rôle de déterminer les orientations de l'activité de la société. 
Actuellement, l'assemblée générale est consisté de 32 salariés. 
Un salarié ne peut pas rester dans l'entreprise si au bout de 3 ans d'ancienneté celui-ci ne veut pas adhérer à la \gls{SCOP}. 
Cette assemblée générale mandate le conseil d'administration constitué des membres élus et en "échange", les membres de conseil anime, représente et rend compte aux associés.

De l'autre côté on trouve la gouvernance de l'entreprise, avec un directeur général, responsable légale qui travail avec un comité opérationnel. 
Ils travaillent avec les différents pôles dans la mise en oeuvre de la stratégie d'entreprise.

La partie décisionnel est aux salariés car c'est bien la gouvernance coopérative qui mandate et pilote la gouvernance d'entreprise qui, elle, propose et rend compte de l'activité.

Une assemblée générale ordinaire à lieu une fois par an pour voter les grandes orientations de l'entreprise, valider les comptes, voter la répartition des bénéfices et également voter pour les nouveaux associées.

\subsection{Responsabilité sociétale et environnemental}
L'axe principal de la démarche \gls{RSE} chez Empreinte Digitale porte sur le numérique responsable, qui intègre à la fois des problématiques environnementales et sociétales.

\noindent%
\begin{minipage}{.7\textwidth}%
Empreinte digitale est officiellement engagée dans une démarche Responsabilité Sociétales des Entreprises (\gls{RSE}) depuis 2018, année de sa labellisation Lucie \gls{ISO} 26000. 
LUCIE est une certification qui prouve qu'une entreprise, un produit ou un service à réussie sa démarche en matières de \gls{RSE}. \cite{Lucie}

\end{minipage}%
\hfill
\begin{minipage}{.3\textwidth}%
\begin{center}
\includegraphics[width=0.6\textwidth]{src/logo_lucie.png}
\end{center}
\end{minipage}% \\

\subsubsection{Design4Green}
Le Design4Green est un challenge organisé depuis 5 par l'ESAIP, une école d'ingénieur Angevine.
Durant ce hackathon de 48h, les équipes doivent répondre sur un sujet autour d'un projet web et de l'éco-conception.
Le projet web doit prendre en considération son empreinte environnementale.

En 2021, le thème portait sur le développement d'une interface pour les professionnel de suivi de l'éco-conception d'un projet web intégrant 491 critères.
Empreinte Digitale à participé à cette édition et l'a remporté avec une application statique, éco-conçu et accessible.
Le site est une "Progressive Web App" (\gls{PWA}), il est alors téléchargé une seule fois et mise en cache dans le navigateur, ainsi il n'y a pas d'aller-retour avec le serveur.

A la clé de ce challenge, un chèque de 1000€ qui fut par la suite placé dans un autre projet \gls{RSE}, le budget participatif.

\begin{figure}[!ht]
    \centering
    \includegraphics[width=\textwidth]{src/interface_d4g.png}
    \caption{Application web réalisé par Empreinte Digitale pour le Design4Green}
    \label{fig:design4greenl}
\end{figure}

\newpage
\subsubsection{Budget participatif}
En 2022, Empreinte Digitale a lancé un appel à projet nommé Budget Participatif. 
Chaque employé pouvait présenter un ou plusieurs projets qui ont été ensuite soumis au vote. 
Le prix gagné au Design4Green a été mis en jeu et une participation supplémentaire de 1000€ a été attribué par l'entreprise. 
Ainsi, c'est 2000€ de projets, proposés par les salariés, qui ont vu le jours. 
Les propositions fûrent nombreuses: console de jeu, abri pour oiseaux, salle de sport, jeu de fléchettes etc.

\subsubsection{Stratosfair}
En 2020, Empreinte Digitale a lancé un partenariat avec Stratosfair. 
L'objectif: créer un datacenter responsable. 
Ce nouveau datacenter à vu le jour deux ans après à Lanester, une ville voisine de Lorient. 
L'idée est d'utiliser des énergies renouvelables produites sur place, la perte d'énergie (chaleur) engendrée par les serveurs et de se "fondre" dans le milieu naturel.
\begin{itemize}
    \item Le datacenter n'est pas posé à même le sol, ne bloquant pas la circulation des organismes vivants.
    \item Une partie de l'énergie qui alimente les serveurs est une énergie renouvelable générée par des panneaux solaires.
    \item La chaleur des serveurs est redirigée dans une serre pour la culture de légumes bio.
\end{itemize}

\begin{figure}[!ht]
    \centering
    \includegraphics[width=\textwidth]{src/scheme_strato.jpg}
    \caption{Maquette en trois dimensions du datacenter de Stratosfair}
    \label{fig:strato}
\end{figure}

Avec ce datacenter, Stratosfair et Empreinte Digitale lancent une offre similaire à celle OVH avec la location de machines virtuelles.
Une application et une \gls{API} ont été développés pour la création de machines virtuelles dans un \gls{cluster} \gls{Proxmox} depuis une interface web.

Vous pouvez retrouver d'autres projets \gls{RSE} ici: \begin{hilite} \url{https://blog.empreintedigitale.fr} \end{hilite}.

\subsection{Pôle datacenter}
Empreinte digitale est constitué de 5 pôles: production, accessibilité numérique, datacenter, RH et commercial/marketing.

J'étais intégré dans le pôle datacenter composé de 7 personnes. 
Les activités sont découpées de la manière suivante:
\begin{itemize}
    \item \textbf{Ligeo}: deux personnes travaillent principalement sur les produits Ligeo. 
    Cela comprend les installations, les mises à jours et la maintenance.
    \item \textbf{Cloud}: une personne travaille sur la conception, les installations et la maintenance des produits cloud. 
    Cela va de l'installation de produits tels que \gls{Nextcloud}, Zammad jusqu'à la conception et l'installation d'architecture spécifique à un besoin. 
    C'est le cas par exemple pour le projet Dehon.
    \item \textbf{Travaux internes}: deux personnes, moi y compris, travaillons sur divers travaux internes. 
    Cela concerne par exemple les installations de PC, les mail, les accès et les installations de nouveaux outils.
    \item \textbf{Commercial}: une personne gère la partie commercial et facturation.
    \item \textbf{Chef de projet}: une personne travaille sur la gestion de projet, en lien avec le commercial.
\end{itemize}

Les activités ne sont pas à ce point-là segmentées. 
Dû au astreinte et à l'entre-aide collective, tout le monde "touche à tout". 
Par exemple, bien qu'ayant travaillé majoritairement sur des travaux internes, j'ai aussi travaillé sur des offres cloud.

\subsection{Comité sécurité}
Empreinte Digitale possède un comité sécurité dans lequel j'ai été intégré à mon arrivé.
Celui-ci est composé d'une dizaine de personnes aux profils variés: développeurs, administrateurs systèmes, testeurs et chefs de projet.

Sa mission est pour le moment de maintenir une veille sur la sécurité afin d'apporter des axes d'améliorations. 
Cela tiens compte du développement, de l'hébergement, la documentation et les bonnes pratiques générales à l'attention de tous. 
Le comité a une réunion mensuel pour suivre l'avancement de divers sujets.

\newpage
\subsection{Gestion de projet}
Deux outils sont très utilisés dans la gestion de projet chez Empreinte Digitale. \\

\noindent%
\begin{minipage}{.7\textwidth}%
\gls{Redmine} est une application web libre de gestion de projets.
Elle est utilisée pour le ticketing en interne et avec les clients.
Les clients possèdent des accès au \gls{Redmine} et peuvent eux-même créer des tickets.
L'outils permet également d'avoir une liste de contacts rattachés aux projets. \\
\end{minipage}%
\hfill
\begin{minipage}{.3\textwidth}%
\begin{center}
\includegraphics[width=0.5\textwidth]{src/logo_redmine.jpeg}
\end{center}
\end{minipage}% \\

\gls{Redmine} a un rôle important dans l'exploitation car il sert pour deux autres aspects.

Dans la comptabilisation du temps, il n'y a pas de système de badgeuse.
Le temps est calculé à partir de la saisie hebdomadaire de chaque employé.

L'autre aspect important concerne la comptabilité.
A partir du système de classification des tickets, la saisie de temps permet de sortir des analytiques comptables.
Par exemple, sur un projet vendu en temps de développement, c'est avec \gls{Redmine} que les chiffres effectifs vont être calculés. \\

\noindent%
\begin{minipage}{.7\textwidth}%
Mattermost est un logiciel libre de messagerie instantanée auto-hébergeable.
Il est une altervative libre à \gls{Slack} ou \gls{Microsoft Teams}.
Comme \gls{Redmine}, certains clients possèdent des canaux Mattermost en plus de \gls{Redmine}.
Cela évite notamment de passer par les mails lors d'échanges répétés. \\
\end{minipage}%
\hfill
\begin{minipage}{.3\textwidth}%
\begin{center}
\includegraphics[width=0.5\textwidth]{src/logo_mattermost.png}
\end{center}
\end{minipage}% \\

Le vendredi en début d'après-midi, une réunion à lieu pour commencer à établir les tâches pour la semaine à venir.
Cela permet d'avoir une première idée du volume horaire.
Le lundi après-midi, tout est validé pour le reste de la semaine.

En tant que stagiaire, je n'avais pas toujours de tickets.
Mes travaux étant souvent internes, je créais des tickets que je m'attribuais.

\newpage
\section{Sujet}
\subsection{Contexte}
Empreinte digitale développe son offre DATACENTER. 
Cela engendre une évolution rapide de l'infrastructure ce qui demande de nouveaux besoins notamment en matière de sécurité. 
En effet, l'entreprise ne possède pas pour le moment d'outils de conformité, d'outils de contrôle de sécurité ni d'outils de \gls{CVE}. 
De plus, il n'y a pas de documentations mis à disposition des salariés afin de spécifier le comportement à avoir lors de l'utilisation du \gls{SI} ou en cas de faille de sécurité révélée.

\subsection{Problématique}
Les problématiques sont multiples:
\begin{itemize}
    \item Comment réaliser un état des lieux du système d'information actuel?
    \item Comment établir les besoins en hiérarchisant les priorités?
    \item Comment faire un choix parmi l'ensemble des outils d'audits disponibles?
    \item Comment pérenniser les solutions mises en oeuvre? 
\end{itemize}

\subsection{Objectifs}
Travailler en mode projet sur l'infrastructure de l'entreprise afin d'améliorer celle-ci en continu. 
Cela passe par la mise en oeuvre de nouveaux outils mais également de nouvelles procédures afin de pérenniser les solutions. 
En parallèle, travailler sur des tâches annexes d'administration système comme installer des plateformes pour les clients, préparer le matériel pour les nouveaux arrivants, etc.

\subsection{Outils et ressources}
Les outils sont nombreux et il n'y a pas de restriction à en mettre en oeuvre de nouveaux. 
Les principaux sont ceux cités dans la section \ref{part: preambule_technique}.

Il n'y a pas de limitation de ressources et matériels.
L'accès aux plateformes vitales à la réalisation des projets est donné avec des droits administrateurs.
Pour les autres plateformes, l'accès est donné ponctuellement lorsque cela est justifié.

L'objectif n'étant pas concentré sur un sujet en particulier, les divers documentations de l'\gls{ANSSI} servent de conseil.

\newpage
\part{Préambule technique}
\label{part: preambule_technique}
\section{Proxmox}
\noindent%
\begin{minipage}{.7\textwidth}%
\gls{Proxmox} est une plateforme open-source complète pour la virtualisation d'entreprise. 
Grâce à l'interface Web intégrée, nous pouvons facilement gérer les machines virtuelles et les conteneurs, le stockage défini par logiciel, la mise en réseau, le clustering haute disponibilité et plusieurs outils prêts à l'emploi sur une seule solution. \\

\end{minipage}%
\hfill
\begin{minipage}{.3\textwidth}%
\begin{center}
\includegraphics[width=0.7\textwidth]{src/logo_proxmox.JPG}
\end{center}
\end{minipage}% \\

\noindent%
\begin{minipage}{.4\textwidth}%
\begin{center}
\includegraphics[scale=0.65]{src/interface_proxmox_side.png}
\end{center}

\end{minipage}%
\hfill
\begin{minipage}{.53\textwidth}%
\gls{Proxmox} possède 3 outils pour manipuler l'ensemble des ressources:
 \begin{itemize}
     \item Un utilitaire en ligne de commande.
     \item Une \gls{API}.
     \item Une interface web.
 \end{itemize}

Depuis l'interface, on visualise l'élément \textit{Datacenter}, correspondant au \gls{cluster}. 
On visualise également chacun des noeuds du \gls{cluster} avec leur nom et leur état. 
On peut y modifier les noeuds, les différents stockages, la configuration de backup avec l'ajout de serveur de backup, les permissions utilisateurs, la haute disponibilité du cluster (HA), les statistiques et le support. \\

Il est également possible d'agir sur les machines virtuelles. 
La vision sur les machines virtuelles résume son état, ses caractéristiques telles que l'usage du CPU, de la mémoire, la taille du disque et les adresses IPs. 
On peut y modifier les caractéristiques hardware des machines virtuelles directement à chaud, agir sur le template, accéder à la console de la machine etc. \\
\end{minipage}% \\

\newpage
\section{Terraform}
\noindent%
\begin{minipage}{.7\textwidth}%
\gls{Terraform}est un outil open source d'infrastructure as code (\gls{IaC}) développé par Hashicorp. 
Il permet de déclarer sous forme de code l'infrastructure que l'on souhaite obtenir. 
Dans des fichiers de configuration structurés, basé sur un système d'état, on va pouvoir manager l'infrastructure et mettre à jours son état. \\

\end{minipage}%
\hfill
\begin{minipage}{.3\textwidth}%
\begin{center}
\includegraphics[scale=0.5]{src/logo_terraform.png}
\end{center}
\end{minipage}%

Au travers de scripts dans un langage propre à \gls{Terraform}, on décrit l'état de l'infrastructure souhaité. 
Son workflow le rend facile à comprendre et à mettre en oeuvre:
\begin{figure}[!ht]
    \centering
    \includegraphics[width=\textwidth]{src/graph_terraform.png}
    \caption{Workflow de \gls{Terraform}}
    \label{fig:graph_terraform.png}
\end{figure}

Après les quelques première écritures de configuration, on va:
\begin{itemize}
    \item Initialiser le projet avec un nouvel état. Commande: \begin{code}\texttt{terraform init}\end{code}
    \item Planifier les configurations. Commande: \begin{code}\texttt{terraform plan}\end{code}
    \item Appliquer les configurations. Commande: \begin{code}\texttt{terraform apply}\end{code}
    \item Détruire les configurations si nécessaire. Commande: \begin{code}\texttt{terraform destroy}\end{code}
\end{itemize}

L'étape d'initialisation permet la création d'un état de l'infrastructure qui sera stocké sous la forme d'un fichier \begin{code}\texttt{terraform.tfstate}\end{code}. 
Cet état permet d'assurer la cohérence entre ce qui est écrit localement et ce qui a déjà été appliqué. 
Dans un travail collaboratif, cet état peut être configuré sur \gls{GitLab} de façon à assurer la cohérence des états entre différents développeurs.

\gls{Terraform} se base sur un fonctionnement autour de \textit{providers} ou fournisseurs. 
Un provider est là pour manager une ressource donnée. 
Ces provider sont nombreux: Amazon Web Services, Google Cloud Plateform, Azure, VmWare Vsphere, \gls{Proxmox} etc.

À ces providers on spécifie des ressources. 
Chaque bloc de ressources décrit un ou plusieurs objets d'un service. 
La construction d'une ressource est basée sur le provider qui la fournie.

Il est également possible de créer des modules afin de les réutiliser. 
Utile par exemple dans le cas de template de machines virtuelles, où les variables sont toujours les mêmes mais où seuls les valeurs changent.

Chez Empreinte Digitale, \gls{Terraform} permet le déploiement dans un premier de temps de machines virtuelles sur des \gls{cluster} \gls{Proxmox}. 
Par la suite, \gls{Terraform} permet d'installer des composants sur ces machines telles que des ressources Kubernetes, MongoDB, Helm, etc.

\newpage
\section{Ansible}
Nous avons vu précédemment l'intérêt de \gls{Terraform} dans l'installation de machines virtuelles ou logicielles à partir de différents fournisseurs. 
Une fois cette étapes effectuée, il peut être nécessaire d'effectuer des configurations supplémentaires. 
C'est là qu'\gls{Ansible} intervient.

\noindent%
\begin{minipage}{.8\textwidth}%
\gls{Ansible} est un logiciel libre de gestion des configurations qui automatise le déploiement de configurations sur un ensemble de machines. 
Celui-ci est basé sur l'utilisation du protocole SSH. 
Cela lui donne l'avantage de ne pas avoir besoin d'installer d'agents sur les machines, parfois consommateur de ressources.

\end{minipage}%
\hfill
\begin{minipage}{.2\textwidth}%
\begin{center}
\includegraphics[scale=0.3]{src/logo_ansible.png}
\end{center}
\end{minipage}%

Au travers de scripts YAML, on décrit l'état souhaité d'une ou plusieurs ressources pour une ou plusieurs machines. 
Ces scripts vont alors exécuter des modules sur les cibles qui essaieront d'appliquer des correctifs afin d'atteindre cet état souhaité. 
On distingue trois principaux types de scripts:
\begin{itemize}
    \item Les \textbf{rôles}. Ce sont un ensemble de playbooks qui s'assurent de la présence ou absence de fonctionnalité spécifique.
    \item Les \textbf{playbooks}. Ce sont un ensemble de tâches d'automatisations.
    \item Les \textbf{tâches}. Une tâche correspond à la description de l'état souhaité d'un composant d'un machine. 
    Cela peut être exemple la présence ou non d'un paquet apt.
\end{itemize}

L'utilisation de rôle n'est pas toujours nécessaire. 
Un rôle à surtout pour vocation de créer une configuration qui sera réutilisée régulièrement. 
Il est donc possible de se limiter à l'utilisation de playbook.

Comme indiqué précédemment, \gls{Ansible} est dit "agentless". 
Cela signifie qu'il n'est pas nécessaire d'installer d'agents sur les cibles. 
Pour réaliser sa mission, \gls{Ansible} n'a donc besoin que trois de pré-requis:  une connexion SSH vers ces cibles, la bonne version de python d'installé sur ces cibles et un inventaire de l'ensemble des cibles.

Lorsqu'un script \gls{Ansible} est exécuté, la première étape consiste toujours à récupérer les \textit{facts}. 
Ces facts sont l'ensemble des informations de la machine cible. 
On aura le nom de la machine, sa version de système d'exploitation, son numéro de version, etc.

A partir de ces informations on peut paramétrer l'utilisation d'\gls{Ansible}. 
Cela va notamment permettre de faire une distinction entre les différents systèmes d'exploitation, leurs versions, leurs logiciels installés etc.

Lorsqu'une tâche \gls{Ansible} est jouée, il y a quatre états principaux:
\begin{itemize}
    \item \begin{code}\texttt{OK}\end{code}: la configuration était déjà correcte, \gls{Ansible} n'a rien changé.
    \item \begin{code}\texttt{SKIPPED}\end{code}: les conditions d'application de la tâche ne sont pas validées. La tâche est ignorée.
    \item \begin{code}\texttt{CHANGED}\end{code}: la configuration n'était pas correcte, \gls{Ansible} à apporté les changements nécessaires avec succès.
    \item \begin{code}\texttt{ERROR}\end{code}: la configuration ne s'est pas bien passée, \gls{Ansible} renvoit l'erreur associée.
\end{itemize}

\newpage
\part{Travaux de sécurité}
\section{Période d'alternance}
Mon sujet \begin{hilite} Analyse et réalisation d'audits automatisés de l'infrastructure \end{hilite} s'est découpé en quatres phases:

\begin{itemize}
    \item \textbf{Analyse abstraite et bonnes pratiques}. J'ai réalisé une veille technologique sur les logiciels et outils utilisés par les administrateurs systèmes. 
    De plus, j'ai pris le temps de me cultiver sur les sujets de sécurité avec les documentations et livres blanc de sécurité de l'\gls{ANSSI} ainsi que les sites de conseils de sécurité.
    \item \textbf{Analyse}. J'ai débuté une analyse de l'infrastructure en me basant sur les critères du référentiel secNumCloud de l'\gls{ANSSI}. 
    Cette analyse n'était pas uniquement technique car parmi les critères de certification, de nombreux points concernent de la documentation.
    \item \textbf{Préconisations}. J'ai rédigé des documentations pour le pôle \gls{sysadmin} et l'ensemble des salariées : livre blanc de sécurité, gls{PSSI} (Plan de sécurité des systèmes d'information), etc.
    \item \textbf{Mise en oeuvre}. J'ai effectué des \gls{POC} sur Rudder et \gls{Ansible CMDB}.
\end{itemize}

A l'issue de mes travaux, j'ai rédigé un \gls{PSSI} et un tableau de suivi d'audit de l'infrastructure. 
Les deux documents sont composés de 16 thématiques présentées en annexe aux pages \begin{hilite} \pageref{tab:16thematiques1} \end{hilite} et \begin{hilite} \pageref{tab:16thematiques2} \end{hilite}.
\begin{figure}[!ht]
    \centering
    \includegraphics[width=\textwidth]{src/table_ssi.png}
    \label{fig:pssi_table}
    \caption{Extrait du tableau de suivi de sécurité}
\end{figure}

J'ai par la suite complété ce tableau afin de mettre en avant les points déjà mis en oeuvre au sein d'Empreinte Digitale et ceux qui ne l'étaient pas.

\newpage
\section{Inventaire des machines}
\subsection{Description}

Dans le cadre de la 4\textsuperscript{ème} thématique portant sur la gestion des actifs, il est nécessaire de tenir un inventaire des ressources informatiques. 
Cela comprend l'ensemble des ordinateurs du personnel, les machines physiques liées au différents datacenters et les machines virtuelles qu'elles hébergent.
La solution retenue est d'utiliser deux logiciels open-source:

\noindent%
\begin{minipage}{.7\textwidth}%
\textbf{Open Computers and Software Inventory (\gls{OCSInventory})} une solution open-source de gestion technique de parc informatique. 
Ce logiciel libre permet l’inventaire hardware et software. 
On va ainsi inventorier des machines avec leurs caractéristiques matériels et logiciels.
\end{minipage}%
\hfill
\begin{minipage}{.3\textwidth}%
\begin{center}
\includegraphics[width=0.7\textwidth]{src/logo_ocsinventory.png}
\end{center}
\end{minipage}% \\

\noindent%
\begin{minipage}{.7\textwidth}%
\textbf{Gestionnaire Libre de Parc Informatique (\gls{GLPI})} est une solution open-source de gestion de parc informatique qui permet la classification des différentes ressources. 
GLPI ne récupère pas les informations lui-même, il a besoin d'un logiciel d'inventaire complémentaire tel que OCSInventory ou FusionInventory.
\end{minipage}%
\hfill
\begin{minipage}{.3\textwidth}%
\begin{center}
\includegraphics[width=0.7\textwidth]{src/logo_glpi.png} 
\end{center}
\end{minipage}% \\

Finalement, \gls{GLPI} va permettre de trier les informations récupérées par OcsInventory.

\subsection{Architecture}
\begin{figure}[!ht]
    \centering
    \includegraphics[width=\textwidth]{src/graph_glpi.png}
    \label{fig:glpi}
    \caption{Architecture entre OcsInventory et \gls{GLPI}}
\end{figure}

\newpage
\subsection{Principe de fonctionnement}
L'application \gls{OCSInventory} fonctionne sur un système d'agent.
C'est-à-dire qu'un agent est installé sur l'ensemble des machines et celui-ci va envoyer des rapports quotidiennement via le protocole HTTP au serveur maître. 

Ensuite, l'application \gls{GLPI} avec un plugin va se connecter à \gls{OCSInventory} et lire les données.
Finalement, par une action manuelle à réaliser dans \gls{GLPI}, je valide les imports.

Un champ TAG configuré au niveau des agents permet une segmentation des machines.
J'ai défini la nomenclature suivante pour les TAGs:
\begin{itemize}
    \item \begin{code}\texttt{ANG-ORD}\end{code}: ordinateurs des salariés d'Angers.
    \item \begin{code}\texttt{ANG-DC}\end{code}: serveurs physiques et machines virtuelles d'Angers.
    \item \begin{code}\texttt{REN}\end{code}: serveurs physiques et machines virtuelles de Rennes.
    \item \begin{code}\texttt{TRS}\end{code}: serveurs physiques et machines virtuelles de Tours.
\end{itemize}

Une fois l'import fait, je peux dans \gls{GLPI} visualiser les machines avec les TAGs associés. 
Le TAG va alors permettre d'effectuer un trie lors de l'import. 
Par exemple, les machines dont le TAG est \begin{code}\texttt{REN}\end{code} seront placées dans l'entité "Datacenter de Rennes".
Lorsqu'un import est validé, \gls{GLPI} écrit les données dans une base de données qui lui est propre. \\

\begin{figure}[ht!]
\noindent%
\begin{minipage}{.5\textwidth}%
\begin{center}
\includegraphics[width=\textwidth]{src/interface_ocsinventory.png} \\
\end{center}
\end{minipage}%
\hfill
\begin{minipage}{.5\textwidth}%
\begin{center}
\includegraphics[width=\textwidth]{src/interface_glpi.png} \\
\end{center}
\end{minipage}% \\
    \caption{Interfaces de \gls{OCSInventory} et \gls{GLPI}}
\end{figure}

\newpage
\subsection{Installation}
Le serveur maitre d'\gls{OCSInventory} est une application conteneurisée sur le \gls{cluster} \gls{Proxmox} d'Angers.
Je n'ai pas eu à installer cette partie, l'application existait déjà.

J'ai installé \gls{GLPI} avec Docker sur une machine virtuelle dédiée aux conteneurs.
J'ai utilisé docker-compose pour les trois services: mariadb, glpi et automysqlbackup.
La partie réseau est gérée avec un routeur traefik.

\subsection{Ajout d'un plugin}
Par défaut, \gls{OCSInventory} ne possède pas de plugin permettant d'inventorier les vhosts. 
Les vhosts sont les noms des sites webs hébergés sur une machine et il est intéréssant de pouvoir déterminer sur quelle machine est installé un site. 
Afin de répondre à ce besoin interne, j'ai repris le travail d'un collègue avec l'écriture de scripts Perl permettant d'inventorier les vhosts des serveurs web Nginx et des conteneurs Docker pour les écrires dans la base de données d'\gls{OCSInventory}.
Le nom des sites ayant une structure comprenant à la fois le service et le nom du client, il est possible de faire du traitement afin de créer une nouvelle table spécifiquement pour le nom des clients.
Cela se fait pas un traitement du même résultat que pour les vhost.

Ce script va dans un premier temps vérifier la présence ou non de la base de données \textit{vhost}.
Si celle-ci existe déjà, il ne fait aucune action, sinon il créer la base de données.

Ensuite, pour récupérer les vhosts des serveurs Nginx, les fichiers de configuration présents dans \begin{code} \texttt{/etc/nginx/sites-enabled}\end{code} sont filtrés par une série de commandes \gls{Linux}.

Voici la commande utilisée pour les vhosts des serveurs Nginx.
\vspace{-1ex}
\begin{code}
\vspace{-1ex}
\begin{center} 
    \line(1,0){0.9\textwidth} 
\end{center}
\vspace{-1ex}
\begin{verbatim}
    grep -EhR 'server_name\\s' $dir | 
    sed 's/^.*server_name\\s\\+\\(.\\+\\)\\s*;/\\1/' |
    sort | uniq |
\end{verbatim}
    \vspace{-1ex}
\begin{center} 
    \line(1,0){0.9\textwidth} 
\end{center}
\end{code}


Enfin, pour récupérer les vhosts des conteneur docker, cela se fait avec la commande docker et jquery (jq).
La commande \begin{code}\texttt{docker ps}\end{code} permet de récupérer l'ensemble des identifiants de conteneurs, une boucle va ensuite effectuer un \begin{code} \texttt{docker inspect}\end{code} sur chacun des IDs puis la commande \begin{code} \texttt{jq}\end{code}  va en sortir le vhost dans le JSON retourné.

Cela donne la commande suivante pour les vhots conteneurs docker:
\vspace{-1ex}
\begin{code}
\vspace{-1ex}
\begin{center} 
    \line(1,0){0.9\textwidth} 
\end{center}
\vspace{-1ex}
\begin{verbatim}
    grep -EhR 'server_name\\s' $dir | 
    sed 's/^.*server_name\\s\\+\\(.\\+\\)\\s*;/\\1/' |
    sort | uniq |
\end{verbatim}
\vspace{-1ex}
\begin{center} 
    \line(1,0){0.9\textwidth} 
\end{center}
\end{code}

\subsection{Installation et configuration de l'agent avec Ansible}
\subsubsection{Bastion SSH}
L'une des problématiques du projet est d'installer les agents sur chacune des machines du \gls{SI}. 
Cela représente environ 700 machines virtuelles. 
Heureusement, l'accès aux différentes machines passe par un Bastion SSH. 
Cela fonctionne par un contrôle d'accès basé sur les rôles (\gls{RBAC}). 
Le rôle \begin{code}\texttt{sysadmin}\end{code} dont je fais partie donne les droits sur toutes les machines. 
La machine \begin{code}\texttt{Passhport}\end{code} permet d'avoir un accès SSH à l'ensemble des machines virtuelles.
C'est donc par cette machine que les scripts \gls{Ansible} seront exécutés.

\subsubsection{Inventaire}
\gls{Ansible} se base sur des fichiers d'inventaire dans lequel on décrit le nom des machines dans différents niveaux de catégories. 
La première chose que j'ai fais est de mettre à jours l'inventaire. 
En effet, la différence de nombre de machines entre le Bastion SSH et l'inventaire \gls{Ansible} mettait en avant qu'il en manquait au niveau d'\gls{Ansible}. 
J'ai alors fais une comparaison entre le listing du Bastion et celui d'\gls{Ansible} pour en ressortir les machines manquantes.

Ensuite j'ai repris la structure de l'inventaire. 
Parmi les différents groupes de celui-ci, il y a trois groupes permettant de distinguer les machines se trouvant sur Angers, Rennes et Tours. 
Cependant, après avoir visualisé l'inventaire sous forme d'arborescence avec la commande \verb|ansible-inventory|, j'ai remarqué qu'il y avait des petites erreurs. 
J'ai corrigé ces erreurs petit à petit en me basant sur la représentation de l'inventaire sous forme de graphique.

\subsubsection{Rôle Ansible}
Un rôle est découpé de la manière suivante:
\vspace{-1ex}
\begin{code}
\vspace{-1ex}
\begin{center} 
    \line(1,0){0.9\textwidth} 
\end{center}
\vspace{-1ex}
\begin{verbatim}
    ocsinventory-agent/
    |-- /default     # Variables par défaut
    |-- /files       # Fichiers supplémentaires
    |-- /meta        # Nécessaire à Ansible Galaxy
    |-- /tasks       # Ensemble des playbooks
    |-- /vars        # Variables supplémentaires
\end{verbatim}
\vspace{-1ex}
\begin{center} 
    \line(1,0){0.9\textwidth} 
\end{center}
\vspace{-1ex}
\end{code}

\begin{itemize}
    \item \begin{code}\texttt{default}\end{code}: variables pour le TAG, le nom des paquets, etc.
    \item \begin{code}\texttt{files}\end{code}: scripts supplémentaires d'installation du plugin.
    \item \begin{code}\texttt{meta}\end{code}: enregistrement du créateur du rôle. Ce dossier est nécessaire pour utiliser \gls{Ansible}-Galaxy.
    \item \begin{code}\texttt{tasks}\end{code}: ensemble des tâches Ansibles.
    \item \begin{code}\texttt{vars}\end{code}: variables supplémentaires s'il est nécessaire de modifier les valeurs pas défaut.
\end{itemize}

\newpage
Le diagramme de séquence ci-dessous met en lumière de façon simplifié les différentes tâches \gls{Ansible}. 
On considère que l'ensemble des tâches se sont déroulées sans erreurs.

\begin{figure}[!ht]
    \centering
    \includegraphics[width=\textwidth]{src/graph_ansible_ocs.png}
    \label{fig:ansible_ocs}
    \caption{Diagramme de séquence de l'installation d'\gls{OCSInventory} avec \gls{Ansible}}
\end{figure}

L'administrateur exécute le rôle \gls{Ansible}.
Cela va lancer une série d'étapes durant lesquelles \gls{Ansible} va se connecter en SSH à la cible.
Dans un soucis de simplicité, on considère ici que la connexion est acceptée et \gls{Ansible} récupère l'ensemble des facts.
Débute ensuite un paramétrage dépendant des facts. 
Dans le cas de cette installation d'\gls{OCSInventory}, cela prend en compte la famille du systèmes d'exploitation et sa version.
A l'issues de ces étapes, divers tâches vont permettre l'installation et la configuration de l'agent sur la cible.

Afin que les salariés installent pas eux-même l'agent, j'ai rédigé une documentation décrivant comment installer et configurer l'agent \gls{OCSInventory} sur Windows, \gls{Linux} et ArchLinux.

La figure \ref{fig:graph_roles_ocs.png} à la page \pageref{fig:graph_roles_ocs.png} a été réalisé avec \begin{code}\texttt{ansible-playbook-grapher}\end{code}.
Cet outils permet de généré un graphique à partir d'un playbook \gls{Ansible}.
Cela fonctionne également avec les roles.
L'ensemble des tâches effectuées lors de l'installation d'un agent \gls{OCSInventory} sur une machine correspond au schéma suivant:
\begin{figure}[!ht]
    \centering
    \includegraphics[scale=0.43]{src/graph_roles_ocs.png}
    \label{fig:graph_roles_ocs.png}
    \caption{Tâches \gls{Ansible} exécutée lors de l'installation d'un agent \gls{OCSInventory}}
\end{figure}

\newpage
\subsection{Bilan}

Bilan des installations: 
\begin{itemize}
    \item L'installation sur les machines d'Angers est terminée.
    \item L'agent est installé sur la majorité des machines de Rennes.
    \item L'agent n'est pas installé sur les machines de Tours. 
    Le réseau d'Angers et Tours n'étant pas encore relié, les agents sur Tours ne peuvent pas communiquer avec le serveur maître sur Angers.
    \item L'ensemble des salariés ont installés l'agent.
\end{itemize}

Concernant les installations, mes travaux sont perfectibles.
Pour le moment, je n'ai pas mis de règles de supression au niveau du serveur \gls{OCSInventory}.
C'est-à-dire qu'il faudrait paramétrer le serveur afin qu'il supprime une machine s'il n'a pas de nouvelles de celle-ci dans les 30 jours.
On pourra alors considérer qu'elle n'existe plus.

Je n'ai pas paramétré de mailing.
Il serait intéressant d'avoir une adresse mail dédiée à la réception des informations du serveur \gls{OCSInventory}.
Cela serait important notamment avant suppression d'une machine pour s'assurer que cela soit justifié.

La solution n'est pas pérenne dans le temps.
La procédure d'installation du nouvelle machine est encore à revoir.
Pour cette raison, les dernières machines installées n'ont pas l'agent d'installé.

\gls{OCSInventory} n'était pas la seule solution.
Une autre architecture aurait été possible en utilisant FusionInventory à la place d'\gls{OCSInventory}. 
L'avantage de FusionInventory est qu'il ne possède pas sa propre base de données. 
Une fois les données récupérées, elles sont inscritent dans la base de données de \gls{GLPI}. 
Cette solution n'a pas été retenue car un serveur \gls{OCSInventory} était déjà utilisé.

\newpage
\section{Durcissement Linux}
\subsection{Objectif}
Dans le cadre de la 8\textsuperscript{ème} thématique portant sur la sécurité liée à l'exploitation, il est nécessaire d'effectuer un durcissement des systèmes \gls{Linux} à l'installation d'une nouvelle machine. 
En effet, une machine installée à partir de l'image d'origine n'est pas suffisamment sécurisée.

Pour répondre à ce besoin, j'ai décidé d'utiliser \gls{OpenSCAP} et \gls{Ansible}. 
L'objectif est d'utiliser les fonctionnalité d'\gls{OpenSCAP} en les automatisant avec \gls{Ansible}.
Je cherche à obtenir pour chaque machine un rapport initial, le script \gls{Ansible} de correctif et un rapport finale après application des correctifs. 

\subsection{Openscap}
\noindent%
\begin{minipage}{.7\textwidth}%
\gls{OpenSCAP} représente à la fois une bibliothèque et un outil de ligne de commande qui peuvent être utilisés pour analyser et évaluer chaque composant de la norme \gls{SCAP}. 
L'outil en ligne de commande (\gls{CLI}), appelé oscap, offre un outil polyvalent conçu pour formater le contenu en documents ou analyser le système en fonction de ce contenu. \cite{OpenSCAP} \\
\end{minipage}%
\hfill
\begin{minipage}{.3\textwidth}%
\begin{center}
\includegraphics[width=0.8\textwidth]{src/logo_openscap.png}
\end{center}
\end{minipage}%

Le \gls{CLI} permet également d'effectuer un scan d'une machine et de générer un rapport HTML.
Depuis ce même rapport, il est possible de générer une ensemble de tâches \gls{Ansible} corrigeant les erreurs.

\subsection{Création de machines virtuelles de test}
Avant de procéder à l'installation et l'exécution d'Openscap sur l'ensemble des machines, il est nécessaire de le tester. 
En effet, l'outil effectuant de nombreuses modifications à la volé, il faut d'abord éprouver la solution afin de s'assurer qu'elle n'entraîne pas de modifications handicapent pour l'exploitation.
Ainsi, afin d'avoir un panel assez large pour effectuer des tests, j'ai créé sur le \gls{Proxmox} d'Angers 6 machines virtuelles:
\begin{table}[ht!]
    \begin{center}
        \begin{tabular}{| c | c | c | c | c |}
        \hline
        Nom de la distribution & Version & Espace disque & CPU & Ram 
        \tabularnewline

        \hline
        Debian & 10 & 32 Gb & 2 & 2 Gb
        \tabularnewline

        \hline
        Debian & 11 & 32 Gb & 2 & 2 Gb
        \tabularnewline 

        \hline
        Ubuntu & 20.04 & 32 Gb & 2 & 2 Gb
        \tabularnewline

        \hline
        Fedora & 36 & 32 Gb & 2 & 2 Gb
        \tabularnewline

        \hline
        Centos & 7 & 32 Gb & 2 & 2 Gb
        \tabularnewline

        \hline
        Centos & 8 & 32 Gb & 2 & 2 Gb
        \tabularnewline
        \hline
        \end{tabular}
    \end{center}
    \caption{Machines virtuelles créées pour les tests avec \gls{OpenSCAP}}
\end{table}

\subsection{Création d'une archive Debian}
L'outil s'installe avec \begin{code} \texttt{\gls{apt}}\end{code}.
Cependant, celui-ci n'est pas les listes des sources de Debian 11. 
J'ai débuté la création de l'archive Debian à partir des sources du paquet mais je n'ai pas réussi pour le moment.

\subsection{Installation et configuration avec Ansible}
À nouveau, c'est avec \gls{Ansible} que la configuration d'Openscap est faite. 
Le diagramme de séquence suivant décrit le processus d'installation. 
Afin de le simplifier, la différenciation entre distribution et version n'est pas représentée.

\begin{figure}[!ht]
    \centering
    \includegraphics[width=\textwidth]{src/graph_ansible_oscap.png}
    \label{fig:ansible_oscap}
    \caption{Diagramme de séquence du fonctionnement d'\gls{Ansible} avec OpenSCAP}
\end{figure}

\newpage
\subsection{Bilan}
Au moment de la rédaction de ce rapport, l'installation et l'exécution d'Openscap n'a pas été réalisée sur l'ensemble des machines. 
Cependant l'ensemble des tests en fonction des distributions est fonctionnel.
En l'état, l'outil est intéressant. 
Il ne peut pour autant pas être mis oeuvre tel quel car certaines règles sont trop restrictives.
Par exemple, une des modifications apportées avec \gls{OpenSCAP} fait que la connexion SSH à l'utilisateur root est désactivée.
Cependant, lorsque l'on passe par le bastion SSH, toutes les connexions se font sur l'utilisateur root.
Appliqué la script en l'état empêcherait l'utilisation du bastion.

\newpage
\section{Documentation}
\subsection{Objectif}
Dans plusieurs des thématiques portant sur la sécurité, un aspect documentaire est mis en avant. 
Il s'agit d'avoir des documents descriptifs de l'infrastructure, de procédures et processus liés à l'exploitation ou de documents juridiques sur les engagements qui doivent être mis en oeuvre entre employeur et salariés, mais aussi clients et prestataire. 
L'objectif est d'avancer sur les documentations manquantes et d'établir un fonctionnement afin d'en assurer la pérennité.

\subsection{Documents}
Lors de l'alternance j'ai travaillé sur la Politique de Sécurité des Systèmes d'Information (gls{PSSI}) ainsi que sur la charte informatique. 
Durant la période de stage, j'ai travaillé sur la reprise de la documentation interne du datacenter afin de rédiger surtout les procédures, politiques et processus déjà mis en oeuvre mais dont il manquait l'aspect documentaire.
De plus, suite à la demande d'un client, j'ai rédigé un Plan d'Assurance Sécurité (\gls{PAS}) spécifiant les devoirs entre prestataires et clients au niveau de l'exploitation des services installés par Empreinte Digitale.

\subsection{Outils}

\noindent%
\begin{minipage}{.7\textwidth}%
La documentation à destination des clients et prestataire est rédigée soit sur le Google Drive soit sur le \gls{Nextcloud} de l'entreprise. 
Quant aux documentations internes au Sysadmin ou à l'ensemble des salariés, celles-ci sont rédigés sur un Wiki.js, une application open-source hébergée en interne. 
Cette application permet de rédiger des documents en markdown depuis une interface web.

\end{minipage}%
\hfill
\begin{minipage}{.3\textwidth}%
\begin{center}
\includegraphics[width=.6\textwidth]{src/logo_wikijs.jpeg}
\end{center}
\end{minipage}%

Wiki.js est une application parfois installée pour des clients. 
Dans le cadre de cette reprise de la documentation, j'ai installé une nouvelle instance avec docker-compose.

\begin{figure}[!ht]
    \centering
    \includegraphics[width=\textwidth]{src/interface_wikijs.png}
    \label{fig:interface_wikijs}
    \caption{Interface web de l'application Wiki.js}
\end{figure}

Je ne suis pas allé plus loin que l'installation et la configuration.
En effet, l'application n'est pas accessible.
Il est nécessaire de changer d'application pour un outil open-source et accessible.
Pour le moment aucune solution n'est retenue.

\newpage
\section{Bilan}
Les outils présentés précédemment ont été mis en application sur l'ensemble du système d'information. 
Cependant, d'autres essaies ont été fait. \\

Durant la période de d'alternance, j'ai fais des essaies avec \gls{Ansible CMDB}. 
Cette solution bien que non retenue pourrait être reconsidérée. 
En effet, l'aspect réseau est problématique.
L'application Ligeo Gestion est majoritairement installée chez les clients.
Pour c'est machines il faudrait donc mettre en place des mécanismes supplémentaires.
Cependant, nous avons une connexion SSH à ces machines.
Cela serait donc plus de mettre d'utiliser \gls{Ansible CMDB}. \\

J'ai également testé Rudder durant l'alternance. 
Techniquement, la solution est intéressante mais coûteuse. \\

De plus, j'ai essayé Wazuh, une plateforme gratuite et opensource de sécurité basé sur un fonctionnement d'agent. 
Celle-ci permet de réaliser du monitoring de sécurité ainsi que de l'application de correctifs.
Néanmoins, le fonctionnement par agent est contraignent et la configuration uniquement via des fichiers XML rend le travail fastidieux.

Enfin, j'ai essayé OpenVas, un outils open-source de scan de vulnérabilités de site WEB permet de générer des rapports sur un nombre illimité de sites. 
Je ne suis pas aller très loin dans l'expérimentation avec mais elle mériterait d'y passer plus temps.

\newpage
\part{Travaux d'administrateur système}
\section{Nextcloud et Collabora}
\noindent%
\begin{minipage}{.7\textwidth}%
\gls{Nextcloud} est une application web libre d'hébergement de fichiers et une plateforme de collaboration. 
Associé à \gls{Collabora}, une suite bureautique, il est possible d'intégrer dans \gls{Nextcloud} l'édition de fichiers en tout genre de façon Collaborative. 
Cette suite logiciel est finalement une alternative libre et open-source à l'utilisation d'outils tels que Google Drive ou OneDrive.
\end{minipage}%
\hfill
\begin{minipage}{.3\textwidth}%
\begin{center}
\includegraphics[width=0.7\textwidth]{src/logo_nextcloud.jpeg}
\end{center}
\end{minipage}% \\

\subsection{Objectif}
Empreinte Digitale installe et héberge régulièrement des instances \gls{Nextcloud} et \gls{Collabora}. 
L'objectif est de simplifier et automatiser au mieux les installations mais également de facilité les mises à jours.
Pour répondre à ces besoins, quatre outils sont utilisés:
\begin{itemize}
    \item \textbf{\gls{GitLab}} pour stocker l'ensemble des ressources nécessaires à l'installation.
    \item \textbf{\gls{Ansible}} pour exécuter différentes tâches.
    \item \textbf{\gls{Ansible} Tower/AWX} pour gérer depuis une interface graphique l'application des tâches.
    \item \textbf{\gls{Jinja}} couplé à \gls{Ansible} pour permettre de générer les fichiers de configurations avec les bonnes variables en se basant sur des templates.
\end{itemize}

\subsection{Description}
L'application repose sur des conteneurs Docker hébergés sur une machine virtuelle, elle-même dans un \gls{cluster} \gls{Proxmox}. On compte cinq composants:
\begin{itemize}
    \item \textbf{\gls{Nextcloud}} notre application principale associée à un serveur web apache dans un unique conteneur.
    \item \textbf{\gls{Collabora}} l'application supplémentaire pour l'édition de texte.
    \item \textbf{\gls{Traefik}} le reverse proxy qui va exposer les sites web \begin{code}\texttt{collabora.cloud-ed.fr}\end{code} et \begin{code}\texttt{nextcloud.cloud-ed.fr}\end{code} représentés sur la figure \ref{fig:nextcloudXcollabora}
    C'est également au niveau de \gls{Traefik} que sont gérés les certificats HTTPs.
    \item Une base de donnée \textbf{PostgreSQL} pour l'applicatif.
    \item Un cache applicatif \textbf{Redis}.
\end{itemize}

\newpage
\subsection{Schéma applicatif}
\begin{figure}[!ht]
    \centering
    \includegraphics[width=\textwidth]{src/graph_nextcloud.png}
    \caption{Schéma applicatif de \gls{Nextcloud} avec \gls{Collabora}}
    \label{fig:nextcloudXcollabora}
\end{figure}

\newpage
\subsection{Utilisation des variables}
Automatiser aux mieux l'installation revient à créer un "Template" d'installation, n'utilisant que des variables. 
On distingue deux types de variables :
\begin{itemize}
    \item \textbf{Les variables d'environnements}. Celles-ci vont décrire le nom du client, la version de \gls{Nextcloud} à installer, les images Docker à utiliser etc. 
    Ce sont les variables qui n'ont pas besoin d'êtres secrètes.
    \item \textbf{Les secrets}. Ce sont d'autres variables obligatoires sauf qu'elles sont sensibles et donc à protéger. 
    C'est le cas notamment des identifiant et mots de passes des services.
\end{itemize}

Les variables sont utilisées à trois endroits différents:
\begin{itemize}
    \item Dans les fichiers docker-compose, qui prennent leurs valeurs dans le fichier \begin{code}\texttt{.env}\end{code}.
    \item Dans le fichier \begin{code}\texttt{.env}\end{code}, qui est généré depuis \gls{Ansible} avec un template \gls{Jinja}.
    \item Dans le template \gls{Jinja}, qui prend ses valeurs dans l'\begin{code}\texttt{inventory}\end{code} AWX et également dans le coffre-fort \gls{Ansible}.
\end{itemize}

J'ai créé un template \gls{Jinja} qui va généré le fichier \begin{code}\texttt{.env}\end{code} en utilisant les variables de l'\begin{code}\texttt{inventory}\end{code} AWX ou le coffre-fort \gls{Ansible}.
Le fichier généré est par la suite déplacé dans le bon répertoire pour être utiliser lors du lancement de la commande \begin{code}\texttt{docker-compose up}\end{code}. 

Au moment d'une nouvelle installation, la personne qui l'effectue doit uniquement spécifier les variables dans l'\begin{code}\texttt{inventory}\end{code} AWX et dans le coffre-fort \gls{Ansible}.

\subsection{Inventaire Ansible}
Le paramétrage des variables pour le rôle et le vault était la première étape. 
Ensuite, il faut mettre à jours l'inventaire \gls{Ansible}.
Avec \gls{Ansible} on peut créer des variables en fonction des groupes.
Je me suis servis de ce mécanismes pour créer une distinction entre les différents vault.
Tout d'abord, j'ai créer le dossier \begin{code}\texttt{group\_vars}\end{code}, dans lequel se trouve 2 dossiers:
\begin{itemize}
    \item  \begin{code}\texttt{aicla}\end{code}: contient le fichier vault.yaml du client aicla.
    \item  \begin{code}\texttt{ed}\end{code}: contient le fichier vault.yaml du client ed.
\end{itemize}

\vspace{-1ex}
\begin{code}
\vspace{-1ex}
\begin{center} 
    \line(1,0){0.9\textwidth} 
\end{center}
\vspace{-1ex}
\begin{verbatim}
    |-- group_vars
    |   |-- aicla               # Vault du client aicla
    |   |   |-- vault.yaml
    |   |-- ed                  # Vault du client ed
    |       |--vault.yaml
\end{verbatim}
\vspace{-1ex}
\begin{center} 
    \line(1,0){0.9\textwidth} 
\end{center}
\vspace{-1ex}
\end{code}

Si un nouveau client doit être ajouté, il suffit de créer un nouveau dossier au nom du client et d'y mettre le fichier de vault.

Ensuite, pour que les \begin{code}\texttt{group\_vars}\end{code} soient effectifs, il faut créer un groupe dans l'inventaire \gls{Ansible} portant le même nom. 
Le fichier \begin{code}\texttt{host}\end{code} faisant office d'inventaire contient:
\vspace{-1ex}
\begin{code}
\vspace{-1ex}
\begin{center} 
    \line(1,0){0.9\textwidth} 
\end{center}
\vspace{-1ex}
\begin{verbatim}
    [aicla]
    aicla-cloud-1 ansible_host=192.168.X.X
    
    [test]
    an-nextcloud-test ansible_host=192.168.X.X
\end{verbatim}
\vspace{-1ex}
\begin{center} 
    \line(1,0){0.9\textwidth} 
\end{center}
\vspace{-1ex}
\end{code}


Il faut comprendre que le groupe \begin{code}\texttt{aicla}\end{code} possède une machine nommée \begin{code}\texttt{aicla-cloud-1}\end{code} dont l'adresse \gls{IP} est \begin{code}\texttt{192.168.X.X}\end{code}. 
Ce groupe possède des variables de groupe, d'où le nom \begin{code}\texttt{group\_vars}\end{code}, spécifiées dans le fichier \begin{code}\texttt{group\_vars/vault.yaml}\end{code}.

\subsection{Utilisation d'AWX}
Une fois l'inventaire et les variables mis à jour, il faut paramétrer AWX. 
Tout se fait par le biais d'une interface web comme ci-dessous:
\begin{figure}[!ht]
    \centering
    \includegraphics[width=\textwidth]{src/interface_awx.png}
    \caption{Interface web d'AWX}
    \label{fig:awx}
\end{figure}

Dans AWX, j'ai créé un projet \begin{code}\texttt{\gls{Nextcloud}}\end{code}. 
Dans ce projet, j'ai fais appel à une source \begin{code}\texttt{Git}\end{code} qui est mon dépôt \gls{GitLab} avec le nom de la branche et les identifiants à utiliser. 

Ce projet AWX n'a pas à être modifié.
Dans la logique d'AWX, on peut avoir de multiples templates utilisant un unique projet.
Ainsi, on aura plusieurs template de création d'instance \gls{Nextcloud} par client utilisant le même Projet.

Ensuite j'ai créé un \begin{code}\texttt{Template}\end{code} utilisant mon projet \begin{code}\texttt{\gls{Nextcloud}}\end{code} et d'autres ressources. 
Les ressources supplémentaires à créer sont:
\begin{itemize}
    \item \textbf{Inventories}: variables d'environnement. 
    \item \textbf{Hosts}: nom de la machine et son adresse \gls{IP}.
    \item \textbf{Credentials}:  accès au dépôt \gls{GitLab} et mot de passe du Vault \gls{Ansible}.
    \item \textbf{Templates}: spécifie l'utilisation des éléments précédemment créé, c'est-à-dire l'inventory, l'host, les credentials et le projet \gls{Nextcloud}.
\end{itemize}

Cela correspond aux sections à gauche sur l'image \refname{fig:awx} au niveau de l'onglet \begin{code}\texttt{Ressource}\end{code}.

\subsection{Rôle Ansible}
Le schéma ci-dessous décrit les actions réalisées par le rôle \gls{Ansible} appelé par \gls{Ansible} AWX. 
Celui-ci ne fait pas apparaître les différentes tâches liés aux dépendances tels que l'installation du module \begin{code}\texttt{pip}\end{code} pour Python.

\begin{figure}[!ht]
    \centering
    \includegraphics[width=\textwidth]{src/graph_ansible_nextcloud.png}
    \caption{Diagramme de séquences des tâches \gls{Ansible} lors de l'installation de \gls{Nextcloud}}
    \label{fig:nextcloud_ansible}
\end{figure}

\newpage
\subsection{Conclusion}
Lorsqu'une personne souhaite installer une nouvelle instance, il lui suffit de télécharger le dépôt \gls{GitLab} et éditer la partie inventaire et vault puis de push ses modifications. 
Ensuite, dans \gls{Ansible} AWX, il ajoute les ressources dont un inventaire, un script d'inventaire, deux informations d'identification et un modèle. 
Enfin, il exécute le modèles, ce qui lance l'installation de l'application.

Dans le cadre d'une installation, il aurait été possible de se limiter à la partie avec les fichiers docker-compose, sans se servir d'AWX. 
Cependant, AWX est particulièrement intéressant dans le maintien à jours des différentes instances. 
En effet, depuis AWX, en allant sur le projet \begin{code}\texttt{\gls{Nextcloud}}\end{code}, on peut y visualiser l'ensemble des ressources liées.

Cela fait donc office de listing de l'ensemble des instances nextcloud installé. 
Si la version d'un composant de nextcloud évolue, il suffit alors de modifier l'inventaire de chacun des modèles.

Ajouté à cela, on assure une installation homogène du produit. 
Dans le cas d'astreinte, on sait où trouver les ressources de l'application directement et ceux peu importe le \begin{code}\texttt{\gls{Nextcloud}}\end{code} sur lequel il faut intervenir.

De plus, il arrive souvent de laisser le fichier \begin{code}\texttt{.env}\end{code} directement sur la machine, ce qui est à éviter. 
Avec l'installation actuelle, le fichier \begin{code}\texttt{.env}\end{code} est généré, utilisé puis supprimé. 
Pour l'administration, l'ensemble des sysadmins enregistrent les mots de passes des vaults dans l'application Bitwarden, ce qui leurs permets dans tous les cas de récupéré les accès à une base de données par exemple.

\newpage
\section{Proxmox}
\subsection{Rappel}
\noindent%
\begin{minipage}{.7\textwidth}%
\gls{Proxmox} est une plateforme open-source complète pour la virtualisation d'entreprise. 
Grâce à l'interface Web intégrée, nous pouvons facilement gérer les machines virtuelles et les conteneurs, le stockage défini par logiciel, la mise en réseau, le clustering haute disponibilité et plusieurs outils prêts à l'emploi sur une seule solution.

\end{minipage}%
\hfill
\begin{minipage}{.3\textwidth}%
\begin{center}
\includegraphics[width=0.5\textwidth]{src/logo_proxmox.jpg}
\end{center}
\end{minipage}% \\


\subsection{Objectif}
Les datacenters de Rennes et Tours utilisent une plateforme de virtualisation nommé \gls{Proxmox}. 
L'objectif est de mettre en oeuvre la même plateforme de virtualisation à Angers. 
Pour cela, 3 serveurs physiques sont disponibles afin de construire un \gls{cluster} à 3 noeuds.

\subsection{Installation physique}
Dans un premier temps, j'ai ajouté une carte fibre 10G pour disposer d'une interface supplémentaire. 
Cette interface est destinée à faire transiter du traffic réseau ayant besoin de plus de débit qu'une simple interface 1G. 
L'interface 1G quant à elle sert à l'administration du serveur.

Dans un second temps, j'ai racké les serveurs dans une baies. 

Enfin, j'ai ajouté des disques \gls{SSD} et \gls{HDD} supplémentaires.
Pour chaque serveur, un disque est réservé à l'installation du système d'exploitation et les autres servent au stockage pour les machines virtuelles.
J'ai formaté chacun des disques destinés au stockage.

\subsection{Installation logiciel}
\subsubsection{Image}
Le système d'exploitation de \gls{Proxmox} s'installe à partir d'un fichier \gls{ISO}. 
Celui-ci est basé sur une image \gls{Debian}. 
J'ai installé une version \gls{Proxmox} VE 7.0 basé sur l'image \gls{Debian} 11 nommé Bullseye à partir d'un disque dur externe bootable IODD. 
Cela permet de ne pas avoir à créer une clé bootable dédiée.

\subsubsection{Réseau}
Depuis l'interface graphique, j'ai configuré la partie \gls{DNS} sur le \gls{DNS} interne et changé l'adresse \gls{IP} sur un réseau en 192.168.22.0/23. 
Le DHCP interne attribue par défaut des adresses sur le réseau 192.168.23.0/23.

Une fois cette étape terminée, les interfaces web de \gls{Proxmox} sont disponibles à l'adresse \gls{IP} configurée sur le port par défaut 8006.
Sur le \gls{DNS} interne, j'ai créé trois enregistrements sur le domaine \begin{code}\texttt{.vt}\end{code}: \begin{code}\texttt{an-virt-pmx-1.vt}\end{code}, \begin{code}\texttt{an-virt-pmx-2.vt}\end{code} et \begin{code}\texttt{an-virt-pmx-3.vt}\end{code}.
Le domaine utilisé est accessible uniquement sur le réseau local.

\subsubsection{Regroupement en cluster}
Depuis l'interface graphique, dans la section \gls{cluster}, j'ai créé un \gls{cluster} en lui donnant un nom et un réseau. 
Il se nomme \begin{code}\texttt{an-virt-pmx}\end{code}.
Ensuite, afin d'ajouter les deux noeuds restants, j'ai récupéré le token d'identification du \gls{cluster}, puis je me suis connecté sur chacun des noeuds. 
Sur chacun d'entres-eux, j'ai spécifié:
\begin{itemize}
    \item L'adresse \gls{IP} du \gls{cluster}, soit l'adresse \gls{IP} d'\begin{code}\texttt{an-virt-pmx-1}\end{code}.
    \item Le token d'identification.
\end{itemize}

À partir de cette étape, depuis l'interface graphique de n'importe quel noeud \gls{Proxmox}, l'ensemble des noeuds sont visibles et accessibles.

\begin{figure}[ht!]
    \centering
        \includegraphics[width=\textwidth]{src/interface_proxmox_main.png}
    \caption{Interface du \gls{cluster} \gls{Proxmox} an-virt-pmx}
    \label{fig:proxmox_virt1}
\end{figure}

Arrivé à ce stade, le \gls{cluster} est fonctionnel. 
Cependant, pour une raison de fiabilité du stockage, j'ai installé et paramétré une solution de stockage nommé \gls{Ceph}.

\newpage
\subsection{Ceph}
\noindent%
\begin{minipage}{.7\textwidth}%
\gls{Ceph} est une solution libre de stockage distribué qui propose trois protocoles: Bloc, Fichiers et Objets.
L'objectif de \gls{Ceph} est d'obtenir un stockage 100\% distribué sans point unique de défaillance.

\end{minipage}%
\hfill
\begin{minipage}{.3\textwidth}%
\begin{center}
\includegraphics[width=0.5\textwidth]{src/logo_ceph.png}
\end{center}
\end{minipage}% \\

\subsubsection{Installation}
Par défaut, une section \begin{code}\texttt{\gls{Ceph}}\end{code} est disponible sur l'interface de chaque noeud de \gls{Proxmox}. 
Cette section permet d'installer \gls{Ceph} lorsque ce n'est pas déjà le cas.
L'installation se fait par un simple clique à réaliser sur chacun des noeuds.

\subsubsection{Object-based Storage Device}
\gls{Ceph} est basé sur l'utilisation de Object-based Storage Device (\gls{OSD}).
Cela représente un système de stockage qui organise les données sous forme d'objets et non pas sous forme de fichier comme on peut en avoir l'habitude.
Cela permet le stockage non structuré de n'importe quel type d'objet.
Les données sont identifiables par un ID unique et des métadonnées comme les dates, les autorisations, les auteurs etc.

\begin{figure}[ht!]
    \centering
        \includegraphics[width=\textwidth]{src/graph_storage.jpeg}
    \caption{Représentation des types de storage par Scaleway's \cite{Scaleway}}
    \label{fig:storage_types}
\end{figure}

\newpage
La configuration d'\gls{OSD} nécessite que les disques soient vierges, d'où l'étape de formatage au niveau matériel.
Ensuite, j'ai ajouté chacun des disques disponibles au \gls{cluster} \gls{Ceph}.
Cela donne la représentation suivante si l'on regarde les quatre disques d'\begin{code}\texttt{an-virt-pmx-1}\end{code}:

\begin{figure}[ht!]
    \centering
        \includegraphics[width=\textwidth]{src/interface_proxmox_disk.png}
    \caption{Disques présents sur le noeud an-virt-pmx-1}
    \label{fig:disk_node1}
\end{figure}

Directement depuis l'interface \gls{Ceph}, on peut visualiser l'ensemble des \gls{OSD}s du \gls{cluster}:
\begin{figure}[ht!]
    \centering
        \includegraphics[width=\textwidth]{src/interface_proxmox_osd.png}
    \caption{Ensemble des \gls{OSD} du \gls{cluster} an-virt-pmx}
    \label{fig:osd_cluster}
\end{figure}

\newpage
J'ai installé deux autres composants pour \gls{Ceph}:
\begin{itemize}
    \item \textbf{\gls{Ceph} Monitor}: démon qui conserve une copie maîtresse de la carte du \gls{cluster}. 
    La carte ou \textit{crush map} est un fichier dans lequel est écrit l'ensemble de ressources \gls{Ceph}: \gls{OSD}, hosts, règles etc.
    Pour un niveau de disponiblité optimale, il est nécessaire d'avoir au moins trois monitors.
    \item \textbf{\gls{Ceph} Manager}: démon qui s'éxecute parallèlement aux monitors pour surveiller l'état du \gls{cluster}.
    Il y a toujours au moins un monitor de présent, mais si il y en a plusieurs, alors seulement un est actif à la fois.
\end{itemize}

\subsection{Storage}
\subsubsection{Pool de storage}
J'ai créé deux pools de storage pour le \gls{cluster}.
Le premier se nomme \begin{code}\texttt{ssd}\end{code}. 
Il est dédié aux systèmes d'exploitation et aux services nécessitant une vitesse de lecture et écriture rapide.
Le second se nomme \begin{code}\texttt{hdd}\end{code}.
Il est dédié au stockage volumineux qui n'est que très rarement lu.

Par exemple, pour une installation d'un \gls{Nextcloud} volumineux, le système d'exploitation avec les applications de \gls{Nextcloud} sont sur un pool \begin{code}\texttt{ssd}\end{code} tandis que les données (les fichiers notamments) sont sur le pool \begin{code}\texttt{hdd}\end{code}.

\subsubsection{CephFS}
\gls{Ceph} possède son propre \gls{FileSystem} nommé CephFS.
J'ai créé un stockage CephFS afin d'y déposer l'ensemble des \gls{ISO} qui pourraient être utiles.
Cela permet de stocker ces images sur un seul noeud et de présenter ce stockage aux autres.
J'y ai déposé des \gls{ISO} pour Ubuntu, Debian, Fedora, CentOS et RockyLinux.

\subsection{Template}
L'utilisation de \gls{Proxmox} et \gls{Terraform} repose sur la création de Template Cloud Init.
Pour faire un template, il suffit de créer une machine virtuelle avec le système d'exploitation souhaité puis de définir cette machine comme Template.
Les templates possèdent les mêmes noms que ceux des \gls{cluster} de Rennes et Tours.
Ainsi, lors de l'utilisation de Terraform, il n'y a pas à changer le nom du template en fonction du cluster.

\newpage
\section{Projet Dehon} \label{dehon}
\subsection{Objectif}
Le groupe Dehon met en oeuvre un dispositif permettant la détection de fuite sur les installations frigorifiques. 
Un Détecteur de Niveau Intelligent (\gls{DNI}) est donc installé sur chacune des installations frigorifique afin de détecter les fuites par méthodes de mesures indirectes.
Chaque DNI est également connecté au système de l'entreprise et les données sont remontées sur une plateforme centralisée et consultable via un portail web. 

Une évolution des réglementations impose aux détenteurs d'installations frigorifiques de justifier d'un contrôle continu de leurs installations et de pouvoir présenter l'ensemble des vérifications ainsi que les opérations d'entretien effectuées.

L'objectif est donc de mettre en place une plateforme cloud pour centraliser l'exploitation de l'ensemble des \gls{DNI} et proposer une offre de service complète de suivi et d'expertise en temps réel des installations frigorifiques.

J'ai travaillé à la réalisation de cette infrastructure avec deux autres membres du pôle sysadmin.

\subsection{Architecture}
Pour des raisons de disponibilité, l'infrastructure du projet se trouve sur trois sites:
\begin{itemize}
    \item \begin{code}\texttt{virt1}\end{code}: \gls{Proxmox} de Rennes sur lequel se trouve un arbiter MongoDB. 
    \item \begin{code}\texttt{virt2}\end{code}: \gls{Proxmox} de Tours à Cyrès sur lequel se trouve un premier \gls{cluster} \gls{Kubernetes}.
    \item \begin{code}\texttt{cogent}\end{code}: \gls{Proxmox} de Tours à Cogent sur lequel se trouve un replica du premier \gls{cluster} de virt2.
\end{itemize}

\newpage
En voici un schéma:
\begin{figure}[!ht]
    \centering
        \includegraphics[width=\textwidth]{src/graph_dehon1.png}
    \caption{Infrastructure sur trois sites physique du projet Dehon}
    \label{fig:graph_dehon1}
\end{figure}

Les serveurs étaient déjà mis en place pour \begin{code}\texttt{virt1}\end{code} et \begin{code}\texttt{virt2}\end{code}. 
Il a cependant fallu allé sur Tours à Cogent pour y installer une machine. 
Cette machine contient un unique \gls{cluster} \gls{Proxmox}. 

Le rattachement du réseau de Cyrès vers Cogent s'est fait avec une fibre noir.
Celle-ci a été installée par le personnel de Cyrès.
La distance entre les deux bâtiments est d'environ 2km.

\subsection{Déploiement des machines virtuelles avec Terraform}
Nous avons commencé par developper l'infrastructure sur \begin{code}\texttt{virt2}\end{code}. 
Nous nous sommes servis de terraform pour déployer les machines virtuelles sur le \gls{cluster}. 

\subsubsection{Les machines et leur rôle}
\begin{itemize}
    \item trois machines virtuelles destinées à être les masters. 
    Dans le conception de \gls{Kubernetes}, ces machines vont etre les cerveaux du \gls{cluster}.
    C'est sur celles-ci que des composant de \gls{Kubernetes} vont permettrent l'orchestration de runner.
    \item trois machines virtuelle destinée à être les workers. 
    Ces trois machines vont être celles qui supportent la charge de travail dans le \gls{cluster}.
    \item deux machines virtuelle en tant que proxy. 
    Elles seront le point d'entrée de l'infrastructure. 
    \item une machines virtuelle pour le stockage. 
    L'ensemble du \gls{cluster} utilisera un stockage partagé.
\end{itemize}

La denomination de ces machines est réfléchie afin d'identifier le client, le role et le nombre de chaque composant. 
Ces noms sont visibles sur le schéma de l'infrastructure.

\subsubsection{Les providers}
Contrairement aux travaux précémment réalisés, on travaille ici avec \gls{Terraform}, on travaille ici avec trois \gls{cluster} \gls{Proxmox} différents.
Cela nécessite de déclarer trois providers: \begin{code}\texttt{proxmox-cogent}\end{code},\begin{code}\texttt{proxmox-virt1}\end{code} et\begin{code}\texttt{proxmox-virt2}\end{code}.
Chacun des provider possède son url, son nom d'utilisateur et son mot de passe.
Ces variables sensibles sont stockées dans un fichier \begin{code}\texttt{secret.tfvars}\end{code}, le fichier \gls{Terraform} pour les secrets.

\subsubsection{Les modules}
Ensuite, j'ai défini différent modules. Pour les \gls{cluster} dupliqués, on utilise quatre modules:
\begin{itemize}
    \item \textbf{dehon-k8s-master-virt2-main}: module pour la création des masters sur \begin{code}\texttt{virt2}\end{code}.
    Un champ spécifique permet de définir que ce module doit être utilisé trois fois pour ainsi créer trois machines virtuelles.
    Terraform permet de créer certain champ avec un système d'incrémentation, ainsi les adresses \gls{IP} ou les noms des machines se feront automatiquement.
    \item \textbf{dehon-k8s-run-virt2-main}: module pour la création des runners sur \begin{code}\texttt{virt2}\end{code}.
    \item \textbf{dehon-k8s-pxy-virt2-main}: module pour la création de deux proxy.
    \item \textbf{dehon-k8s-storage-virt2-main}: module pour la machine de stockage.
    Celle-ci possède la particularité d'avoir deux disques, le premier pour le système d'exploitation et le second de 2 To pour les données.
\end{itemize}

Le rôle et l'architecture des machines installées avec les deux derniers modules de la liste ci-dessus seront présentés plus tard.

A l'issue de cette étapes, on obtient le \gls{cluster} présenté sur la figure \ref{fig:graph_dehon1} avec trois autres machines virtuelles.

\subsubsection{Déploiement du cluster Kubernetes avec Kubespray}
A présent que les machines virtuelles du \gls{cluster} \gls{Kubernetes} sont installées, il a fallu installer le \gls{cluster} \gls{Kubernetes}.

\subsubsection{Kubespray}
\gls{Kubespray} est un utilitaire basé sur \gls{Ansible} qui permet le déploiement automatisé d'un \gls{cluster} \gls{Kubernetes}.
Le dépôt GitHub du projet est disponible ici: \\ \begin{hilite}\url{https://github.com/kubernetes-sigs/kubespray}\end{hilite}.

\subsubsection{Mise à jours de l'inventaire}
La première étape consiste à mettre à jours l'inventaire \gls{Ansible}.
Pour cela, un exemple est donné dans le dépôt \href{https://github.com/kubernetes-sigs/kubespray/blob/master/inventory/sample/inventory.ini}{ici}.
On y voit un inventaire basé autour des composants vitaux de \gls{Kubernetes}:
\begin{itemize}
    \item \textbf{kube\_controle\_plane}: cerveau de \gls{Kubernetes}.
    Ce composant doit donc être installé sur les noeuds master.
    \item \textbf{etcd}: base de données clé-valeur reposant sur un tableau à deux colonnes.
    La première contient la valeur.
    La second contient la clé.
    Cette base contient la totalité de la configuration du \gls{cluster} \gls{Kubernetes}.
    Ce fichier est vitale à la reconstruction d'un \gls{cluster} en cas de sinistre.
    \item \textbf{kube\_node}: ce sont les travailleurs.
\end{itemize}

Cette structure permet l'installation des bons composants de \gls{Kubernetes} au bons endroits.

\subsubsection{Paramétrage de Kubespray}
Le nombre de paramètres possibles est gigantesque.
Pour cette partie je n'ai donc pas que paramétrer les paramètres que je connaissais:
\begin{itemize}
    \item \textbf{loadbalancer\_apiserver}: les noeuds slaves communiquent via \gls{API} aux masters.
    \item \textbf{loadbalancer\_apiserver\_port}: port d'accès à l'\gls{API}.
    \item \textbf{kube\_network\_plugin}: différents plugin Kubernete existent pour le réseau.
    Dans notre cas, on utilise calico.
    \item \textbf{kube\_apiserver\_ip}: même valeur que le loadbalancer\_apiserver.
\end{itemize}

\subsection{Configuration des 2 Haproxy}
La configuration des deux proxys se fait avec un rôles \gls{Ansible}.
Le paramétrage des variables permet la génération des fichiers de configurations à partir de template \gls{Jinja}.
Quatre fichiers sont dédiés aux configurations de bases de l'Haproxy.
Un autre fichier, qui est le plus important, contient les différentes configurations des frontend et backend.

J'ai édité ce fichier de façon à qu'il se génère le fichier de configuration en fonction du nom du projet, des adresses \gls{IP} autorisées etc.
La présence de boucle dans le template \gls{Jinja} permet d'auto-générer un ensemble de champs \begin{code}\texttt{server}\end{code} à partir de la liste des serveurs.
C'est par exemple le cas pour les différents backend sur l'ensemble des master et runner.

\subsection{Configuration de la VIP sur les proxy}
Le champ \begin{code}\texttt{loadbalancer\_apiserver}\end{code} a été paramétré sur l'adresse 10.2.11.100.
Cela correspond à la \gls{VIP} entre les 2 proxy.
Graĉe à cette \gls{VIP}  (Virtual \gls{IP}), nous n'avons plus de SPOF (Single Point Of Failure) pour l'\gls{API} Server.
Pour mettre en place cette \gls{VIP} , j'ai utilisé un playbook \gls{Ansible} qui permet d'installer KeepAlived.
KeepAlived s'appuie sur le protocole VRRP (Virtual Router Redundancy Protocol) conçu pour gérer une adresse \gls{IP} virtuelle entre plusieurs hôtes.
Concrètement, c'est une adresse \gls{IP} qui se balade entre les deux proxys.

Après l'installation et la configuration de KeepAlived avec \gls{Ansible}, l'interface réseau \verb|eth0| de \verb|dehon-k8s-pxy-1| possède deux adresses: \verb|10.2.11.80| et \verb|10.2.11.100|.
L'interface \verb|eth0| de \verb|dehon-k8s-pxy-2| ne possède que l'adresse \verb|10.2.11.81|.
Si le service KeepAlived ou Haproxy s'arrête, ou pire encore si une des machines s'arrête, alors la \gls{VIP}  \verb|10.2.11.100| bascule sur l'autre machine.

On assure ainsi une redondance de l'accessibilité à l'\gls{API} Server.

\subsection{Stockage NFS externalisé}
\gls{Ansible} est à nouveau utilisé pour déployer le NFS sur la machine de storage.
L'installation est basée sur l'utilisation du paquet apt \verb|nfs-kernel-server|.
Le chemin d'export est également paramétré sur le point de montage \verb|/srv/nfs/shared|.

La machine possède un premier disque de 50G pour le système d'exploitation et un second pour le stockage de 2To.
J'ai fais un point de montage \verb|/srv/nfs/shared| sur l'entierté du disque de stockage.

La suite de la configuration se fait au niveau du \gls{cluster} \gls{Kubernetes}.
Il faut déclarer une nouvelle StorageClass (sc) qui utilisera le serveur NFS.
Pour cela, j'ai utilisé le provider "Helm" avec la ressource "kubernetes\_storage\_class".
Les paramètres principaux à spécifier sont l'adresse du serveur et le chemin:
\vspace{-1ex}
\begin{code}
\vspace{-1ex}
\begin{center} 
    \line(1,0){0.9\textwidth} 
\end{center}
\vspace{-1ex}
\begin{verbatim}
    parameters = {
        server = "10.2.11.70"
        share  = "/srv/nfs/shared"
    }
\end{verbatim}
\vspace{-1ex}
\begin{center} 
    \line(1,0){0.9\textwidth} 
\end{center}
\vspace{-1ex}
\end{code}



Le Physical Volume Claim (PVC) des applications utilisant la StorageClass (SC) nfs-csi sont alors montés sur le serveur NFS.
A l'issue de cette installation, j'ai réalisé des tests de performance des disques.
Pour cela, j'ai utilisé les commandes \begin{code}\texttt{hdparm}\end{code}|hdparm| et \begin{code}\texttt{fio}\end{code}.

\subsection{Les ressources Kubernetes}
J'ai participé à l'installation de nombreuses ressources du Cluster \gls{Kubernetes}.
Toutes ces ressources on été installées avec le provider "Helm" de \gls{Terraform}.

Voici la liste de ces ressources:
\subsubsection{Ingress Controller}
Ingress Controller nginx. Un Ingress est un composant \gls{Kubernetes} qui permet de relier une URL à un service.
Un IngressController est un composant qui permet de piloter l'implémentation de l'ensemble des Ingress.
L'IngressController va gérer le traffic externe au \gls{cluster} vers l'ensemble des PODS.

L'image ci-dessous présente le fonctionenemnt de l'IngressController d'Nginx:

\begin{figure}[!ht]
    \centering
        \includegraphics[width=\textwidth]{src/graph_nginx.png}
    \caption{Schéma de l'IngressController Nginx provenant de la documentation Nginx}
    \label{fig:graph_nginx.png}
\end{figure}

\subsubsection{Cert Manager}
Cert manager permet la centralisation des demandes certificats pour les différentes ressources du \gls{cluster} \gls{Kubernetes}.
Cela simplifie l'option, le renouvelle et l'utilisation des certificats.

\subsubsection{Rancher}
Rancher est une application qui permet de nombreuses choses dans un \gls{cluster} \gls{Kubernetes}: managements des ressources, droits utilisateurs, règles réseaux etc. 
Rancher fournit une interface WEB optimale pour la gestion d'un \gls{cluster}.

\begin{figure}[!ht]
    \centering
        \includegraphics[width=\textwidth]{src/interface_rancher.png}
    \caption{Interface Rancher de l'infrastructure \gls{Kubernetes} du projet Dehon}
    \label{fig:rancher_interface}
\end{figure}

\gls{Terraform} m'a également permis de configurer les accès utilisateurs à l'application de Rancher ainsi que la création des namespaces (n) prod, qualif et test.

\subsubsection{Monitoring}
Je n'ai pas travaillé sur la partie interface de monitoring.
A titre indicatif, les solutions utilisées sont: Alertmanager, Grafana et Prometheus.

\subsubsection{Journaux de log}
La gestion de l'ensemble des logs se fait avec Loki.
Loki est un système d'agrégation de journaux inspité de Prometheus.
Il est utilisé en combinaison de Grafana.

\subsubsection{Sauvegardes}
La solution de backup retenue est Velero.
C'est une solution de backup opensource dédié à \gls{Kubernetes}.
Cette solution permet le disaster recovery, la migration des données et leur protection.

Pour externaliser les sauvegarde, j'ai utilisé minIO.
MinIO est un serveur compatible S3 facile à mettre en oeuvre.
Un serveur S3 est un serveur de stockage sous forme d'objet manipulable via HTTP.
Ainsi, on intéragit avec les objets aves des requêtes PUT, GET, DELETE etc.

\subsubsection{Base de données MongoDB et MongoArbiter}
Les applications utilisent une base de données MongoDB.
J'ai travaillé sur l'installation et la configuration d'une partie.

Il faut garder à l'esprit qu'en cas de désastre, l'applicatif doit basculer l'écritures des données d'une base de données présente sur le premier \gls{cluster} vers une autres base sur le \gls{cluster} de Backup.
Ce mécanismes est pris en compte avec MongoDB avec un composant MongoArbiter.
MongoArbiter permet de simplement de déclarer la base de données dans laquel l'applicatif doit écrire.

Après l'installation de la machine virtuelle comme à son habitude avec \gls{Terraform}, j'ai automatisé l'installation de l'Arbiter avec \gls{Terraform} sur celle-ci.
L'arbiter est dans une application docker.
L'utilisation des commandes docker et docker-compose n'est pas prise en compte par défaut avec \gls{Ansible}.
Il est nécessaire dans un premier temps d'installer la commande \verb|pip| et les module \verb|docker| et \verb|docker-compose|.

Avec ce module, j'ai créer une task \gls{Ansible} qui lance la création d'un conteneur à partir de l'image \verb|killercentury/mongo-arbiter|.
J'ai ajouté dans la section \verb|environnement| les identifiants de connexion à la base de données maître ainsi que son URL.

\newpage
\subsection{Schéma de le partie applicative}
\begin{figure}[!ht]
    \centering
        \includegraphics[width=\textwidth]{src/graph_dehon2.png}
    \caption{Cluster \gls{Kubernetes} de dehon sur virt2-prd-pmx}
    \label{fig:graph_dehon2}
\end{figure}

\subsection{Bilan}
Ce projet a été extrêment intéressant sur de nombreux point.
Il a tout d'abord renforcer mes compétences dans l'utilisation d'\gls{Ansible} et \gls{Terraform} avec des besoins plus compliqués que ce que j'avais pu mettre en oeuvre précédemment.

De plus, le projet portant sur \gls{Kubernetes}, j'ai pu mettre oeuvre les compétences acquises en cours. 
Cela m'a permis de renforcer mes compétences sur \gls{Kubernetes} tout en les développants avec la découverte de nouveaux composants \gls{Kubernetes}.
J'ai vu la différence entre le \gls{cluster} mis en place lors de cours et celui d'un \gls{cluster} de production.
Toujours lié à \gls{Kubernetes}, cela m'a permis de découvrir les helm, \gls{Kubespray}, k9s etc.

Du début à la fin, j'ai pu travaillé sur la mise en oeuvre de chaque étape d'une infrastructure: réseau, sécurité, supervision, sauvegarde, tests, redondance etc.
J'ai observé tout le cheminement de pensé permettant de répondre à un besoin spécifique.



\newpage
\section{Procédure d'arrivée}
\subsection{Objectif}
L'arrivée d'une nouvelle personne au sein d'Empreinte Digitale nécessite l'installation et la configuration de nombreuses choses.
Une procédure existait déjà mais elle n'était pas suffisamment exhaustive.
L'objectif est d'étoffer l'existant afin de rendre l'arrivé d'un nouvel employé plus fluide.

\subsection{Description}
La documentation en interne se trouve sur deux Wiki.js.
Le premier est à destination de l'ensemble des salariés et le second concerne uniquement les sysadmins.
La nouvel documentation étant destiné uniquement aux sysadmins, celle-ci est sur le second wiki.js.

Précédemment, lorsqu'un nouvel employer arrivait, c'était à lui de suivre la documentation interne pour installer les applications nécessaires.
Aujourd'hui, lorsqu'un nouveau salarié arrive, tout est déjà prêt et il possède les accès minimum. 

\subsection{Documentation}
J'ai rédigé un ensemble de fichier \gls{Markdown} pour la documentation. 
Celle-ci comprend treizes sections dont certaines sont spécifiques au rôle de l'employer dans l'entreprise (peu de chance qu'un RH utilise docker).

La première partie concerne le matériel en fonction des besoins du nouveau salarié.
En effet, en amont de son arrivé, le nouvel arrivant est contacté afin qu'il spécifie le matériel avec lequel il souhaite travailler: nombre d'écran, taille de PC, système d'exploitation etc.
La seconde partie décrit la création de comptes mail, \gls{LDAP} etc. et le paramétrage des droits.
Enfin, il y a l'installation et le paramétrage de l'ensemble des applications sur la machines.
Cela comprend une petite dizaine d'applications.

Globalement, l'installation d'un nouveau poste prend 2H. 
Je prenais plus de temps que cela au départ car je rédigeais la documentation en parrallèle. 
De plus, étant donné qu'il n'y avait pas de documentation existante, cela prenait parfois du temps d'avoir les informations. 

\subsection{Groupe de Travail Embarquement}
Lorsqu'une problématique générale survient comme celle de la gestion des nouveaux arrivants, des groupes de travail (GT) se forment pour discuter et mettre en oeuvre une solution.
Étant la personne en charge de l'installation des PCs pour les nouveaux arrivants, j'ai représenté la partie sysadmin au GT embarquement qui porte sur l'intégration et les prépratifs avant une nouvelle arrivée.
Le groupe de travail était constitué d'un sysadmin (moi), une RH et trois développeurs.

Celui-ci s'est conclu par l'ajout de nouvelles installations telles que docker, un système de bookmarks etc.
\newpage
\section{Autres}
\subsection{Commandes Linux}
En 2ème année de cycle ingénieur, nous avons des cours d'administration des systèmes \gls{Linux}.
Lors de mon stage, je n'ai travaillé que sur des OS \gls{Linux}.
Cela m'a permis de développer mes compétences sur le domaine en apprennant de nombreux outils.

Quelques commandes que je ne connaissais pas:
\begin{itemize}
    \item \begin{code}\texttt{dig, nslookup}\end{code}: outils permettant le questionnement sur un lien vers un serveur \gls{DNS}. 
    \item \begin{code}\texttt{dmesg}\end{code}: affiche les logs du "kernel ring buffer" = espace mémoire qui contient les messages du noyau.
    \item \begin{code}\texttt{smartctl}\end{code}: permet d'afficher des informations sur un disque dur. 
    \item \begin{code}\texttt{env}\end{code}: print les variables d'environnement du système.
    \item \begin{code}\texttt{dpkg-reconfigure}\end{code}: permet de reconfigurer un paquet déjà installé.
    \item \begin{code}\texttt{zsh}\end{code}: interpréteur de commandes, tout comme bash. 
    \item \begin{code}\texttt{brctl}\end{code}: permet de configurer les interfaces de bridges.
    \item \begin{code}\texttt{history}\end{code}: permet de récupérer l'historique des commandes utilisées.
    \item \begin{code}\texttt{arp-scan}\end{code}: utilise le protocole arp pour découvrir et marquer des hôtes \gls{IP} sur le réseau local.
    \item \begin{code}\texttt{tcp-dump}\end{code}: analyseur de paquets en ligne de commande.
    \item \begin{code}\texttt{tmux}\end{code}: terminal multiplexeur.
    \item \begin{code}\texttt{time}\end{code}: affiche un résumé des ressources utilisées par le système
    \item \begin{code}\texttt{iptables-save}\end{code}: permet de faire un dump de l'ensemble des règles iptables
    \item \begin{code}\texttt{watch}\end{code}: permet d'exécuter une commande en affichant directement la sortie.
    \item \begin{code}\texttt{docker-compose down -v}\end{code}: stop tous les service et détruit les volumes.
    \item \begin{code}\texttt{blkid}\end{code}: affiche les informations sur les block devices de la machine.
    \item \begin{code}\texttt{fio}\end{code}: outils pour produire des écritures ou des processus d'entrées/sorties spécifié par l'utilisateur.
    \item \begin{code}\texttt{lsmod}\end{code}: afficher la liste des modules du noyau chargés en mémoire. 

\end{itemize}

Je tiens un fichier avec l'ensemble des commandes que je ne connais pas.
J'y note la description et parfois des exemple ou contextes d'utilisation.


\subsection{Tmux}
L'outil qui a totalement changé mon utilisation et mon efficacité sur une console est Tmux.
Tmux est un multiplexeur de terminal.
C'est-à-dire que depuis une même fenêtre je peux avoir plusieurs terminals d'ouvert en même temps.
Je peux agir sur le nom, la taille, le découpage etc.
C'est un outil qui s'utilise uniquement avec des raccourcis clavier.
Cela demande donc une période d'adaptation mais une fois maîtrisé le gain est considérable.

\begin{figure}[!ht]
    \centering
        \includegraphics[width=\textwidth]{src/interface_tmux.png}
    \caption{Interface Tmux avec trois fenêtres}
    \label{fig:tmux}
\end{figure}

Un autre outil très utile tous les jours est l'interpréteur ZSH.
C'est un interpréteur paramétrable avec beaucoup de fonctionnalité.
Il est notamment intéressant dans l'utilisation de Git en terminal.

\begin{figure}[!ht]
    \centering
        \includegraphics[width=\textwidth]{src/interface_shell.png}
    \caption{Interface zsh dans un dossier Git}
    \label{fig:zsh}
\end{figure}

\newpage
\subsection{K9s}

Enfin, l'outils K9S est très pratique dans l'utilisation de \gls{Kubernetes}.
Il permet de facilement visualiser l'ensemble des informations d'un \gls{cluster} et donne la possiblité d'agir dessus.
On peut détruire, créer ou éditer des ressources directement depuis l'interface.

Dans le cadre du projet Dehon, je n'ai pas eu à m'en servir souvent.
Cependant, pour les tâches à venir, je sais que c'est un outils que pourrais être amener à utiliser quotidiennement.

\begin{figure}[!ht]
    \centering
        \includegraphics[width=\textwidth]{src/interface_k9s.png}
    \caption{Visualisation des pods avec K9s}
    \label{fig:k9s}
\end{figure}

Vim est le prochain outil à prendre en main.

\newpage
\section{Bilan}

\newpage
\part{Bilan personnel}


\newpage
\section*{Annexes}
\addcontentsline{toc}{section}{Annexes}
\subsection*{Les 16 thématiques de sécurité}
\addcontentsline{toc}{subsection}{Les 16 thématiques de sécurité}
\begin{table}[!ht]
    \newcolumntype{M}[1]{>{\raggedright}m{#1}}
    % \center
    \begin{tabular}{|c|M{4cm}|M{11.5cm}|}
        \hline
        N° & \begin{center} Thèmes \end{center} & \begin{center}
            Description
        \end{center} 
        \tabularnewline
        
        \hline
        1 & Politique de l'information et gestion du risque & Il s'agit d'assurer l'utilisation de logiciels stables avec des suivi de correctifs. 
        De la documentation approuvée par la direction doit être rédigée afin d'assurer l'évolution du \gls{SI} en matière de sécurité.
        \tabularnewline
        
        \hline
        2 & Organisation  de la sécurité de l'information & La sécurité de l'information doit être documentée en spécifiant les acteurs principaux sur chacun des domaines : développement applicatif, infrastructure, RGPD etc.
        \tabularnewline
        
        \hline
        3 & Sécurité des ressources humaines & L'exploitation d'un \gls{SI} passant par ses utilisateurs, ils sont une sources indéniables de faille possible. 
        Les employés doivent être formés à la sécurité du \gls{SI} et avoir accès en permanence à des documentations rappelant les règles de sécurité à appliquer. 
        \tabularnewline
        
        \hline
        4 & Gestion des actifs & Le matériel du personnel ainsi que toutes autres machines sur lesquelles reposent l'exploitation du \gls{SI} doit être inventorié.
        \tabularnewline
        
        \hline
        5 & Contrôle d'accès et gestion des identités & L'utilisation du \gls{SI} doit se faire de manière à pouvoir en tout temps identifier l'identité d'une personne l'exploitant. 
        Même si cela peut être contraignant dans l'exploitation, il n'est pas question d'ouvrir les accès à une ressources si la personne n'en a pas besoin. 
        L'ajout, la modification ou la suppression d'un accès quel-qu'il soit doit être documenté et archivé afin d'assurer un suivi.
        \tabularnewline

        \hline
        6 & Cryptologie & Des mécanismes cryptographique sécurisés doivent être employés lors de l'utilisation de protocoles tels que TLS, IPsec ou SSH.
        \tabularnewline
        
        \hline
        7 & Sécurité physique et environnementale & La sécurité des logicielles n'est pas suffisante. 
        Un aspect réglementaire oblige le découpage de zone d'accès aux différentes bâtiments. 
        Des mécanismes contre les sinistres tels que des inondations, coupures d'électricité ou incendie doivent permettre la continuité de l'activité.
        \tabularnewline

        \hline
        8 & Sécurité liée à l'exploitation & Il a de nombreuses règles lié à l'exploitation. 
        Celles-ci sont généralement liées aux autres sections du gls{PSSI} avec une prise en compte par exemple de l'exploitation de données sensibles, l'accès aux ressources informatiques, le nomadisme etc.
        \tabularnewline
        \hline
\end{tabular}
\caption{Les 16 thématiques de sécurité - Partie 1}
\label{tab:16thematiques1}
\end{table}

\newpage
\begin{table}[!ht]
    \newcolumntype{M}[1]{>{\raggedright}m{#1}}
    \center
    \begin{tabular}{|c|M{4cm}|M{11.5cm}|}
        \hline
        N° & Thèmes & \begin{center}
            Description
        \end{center} 
        \tabularnewline
        \hline
        9 & Sécurité des communications et réseau & Les différents équipements réseaux nécessitent des configurations supplémentaires. 
        Cela concerne les réseaux Wifi et Ethernet ainsi que les accès aux ressources distantes. 
        Des mécanismes de surveillance sur le \gls{SI} doivent permettre la mise en avant d'une activité non-autorisée.
        \tabularnewline

        \hline
        10 & Acquisition, développement et maintenance des systèmes & Une des tâches les plus importante et pour autant ardue concerne la maintenance du système existant. 
        Il s'agit de garder les systèmes à des niveaux de sécurité satisfaisant sans impacter son exploitation. 
        Cela nécessite une vision en temps réel de l'état de l'infrastructure.
        \tabularnewline

        \hline
        11 & Relations avec les tiers & L'ouverture d'accès aux tiers sur des ressources du \gls{SI} nécessite des procédures et documentations engageant la responsabilité des tiers en cas de faille. 
        Il est nécessaire de maintenir un listing des tiers et des ressources auxquels ils ont accès.
        \tabularnewline

        \hline
        12 & Gestion des incidents liés à la sécurité de l'information & De la documentation doit permettre l'évaluation rapide du niveau de criticité d'un incident. 
        Cette même documentation doit ensuite établir les acteurs à contacter : RSSI, DG, client etc.
        \tabularnewline

        \hline
        13 & Continuité d'activité & Le Plan de Continuité d'Activité (PCA), et le Plan de Reprise d'Activité (PRA) doivent prendre en comptes différents cas de figures afin d'assurer un maintien de l'activité en cas de sinistre.
        \tabularnewline

        \hline
        14 & Conformité & L'aspect conformité impose d'être en mesure d'assurer l'harmonisation des systèmes entre ce qui est prévu et effectif.
        \tabularnewline

        \hline
        15 & Poste de travail & Le développement du télé-travail nécessite de porter une attention particulière aux personnes en distanciel. 
        Leurs ordinateurs sont à configurer en conséquence.
        \tabularnewline

        \hline
        16 & Exigences supplémentaires & Les certifications imposent des aspects supplémentaires tels que la mise en oeuvre de convention de service avec les clients, l'obligation de stockage sur le territoire Européens etc.
        \tabularnewline

        \hline
\end{tabular}
\caption{Les 16 thématiques de sécurité - Partie 2}
\label{tab:16thematiques2}
\end{table}

\newpage
\subsection*{CV}
\addcontentsline{toc}{subsection}{CV}
\begin{center}
    \includegraphics[scale=0.9]{src/annexe_cv.png}
\end{center}

\newpage
\subsection*{Planning détaillé de la période d'alternance}
\begin{table}[!ht]
\newcolumntype{M}[1]{>{\raggedright}m{#1}}
\center
\begin{tabular}{|c|c|M{11.5cm}|}
    \hline
    N° & Semaine & \begin{center}
        Description
    \end{center} 
    \tabularnewline
    
    \hline
    36 & 06/09/21 - 12/09/21 & Découverte de l'entreprise et ses locaux. 
    Sensibilisation à l'accessibilité numérique et formation à la \gls{RGPD}. 
    Début de recherches documentaires basées sur les documentations de l'\gls{ANSSI}.
    \tabularnewline
    
    \hline
    37 & 13/09/21 - 19/09/21 & Pas de jours en entreprise.
    \tabularnewline
    
    \hline
    38 & 20/09/21 - 26/09/21 & Poursuite des recherches documentaires. 
    Rendez-vous de mise au point sur l'ensemble de l'infrastructure technique du \gls{SI}. 
    Veille technologique sur les technologies/logiciels inconnues.
    \tabularnewline
    
    \hline
    39 & 27/09/21 - 03/10/21 & Mise en place d'un compte sur \gls{YesWeHack}. 
    Poursuite de la veille technologique. Ouverture des accès aux machines physiques et virtuelles.
    \tabularnewline
    
    \hline
    40 & 04/10/21 - 10/10/21 & Réunion avec le \gls{DPO} pour identifier les besoins de sécurité liés à la \gls{RGPD}. 
    \gls{POC} sur le logiciel \gls{Rudder} pour de la conformité d'infrastructure.
    \tabularnewline
    
    \hline
    41 & 11/10/21 - 17/10/21 & Ajout d'un agent et paramétrage de tests sur divers thématiques. 
    Réalisation d'un tableau d'audit pour l'ensemble des points mis en avant par la documentation de l'\gls{ANSSI}.
    \tabularnewline
    
    \hline
    42 & 18/10/21 - 24/10/21 & Pas de séance de \gls{PFE} cette semaine.
    \tabularnewline
    
    \hline
    43 & 25/10/21 - 31/10/21 & Poursuite de l'audit de l'état actuel de l'infrastructure à partir du tableau d'audit. 
    Ajout d'onglets plus spécifiques pour chacune des 15 sections du tableau.
    \tabularnewline
    
    \hline
    44 & 01/11/21 - 07/11/21 & Semaine complète excepté pour le lundi férié. 
    Amélioration du tableau d'audit et poursuite de celle-ci. 
    Veille sur les recommandations de l'\gls{ANSSI} pour les protocoles \gls{IPsec}, \gls{TLS} et \gls{SSH}. 
    Rédaction du livre blanc de sécurité.
    \tabularnewline
    
    \hline
    45 & 08/11/21 - 14/11/21 & Séance de \gls{PFE} le vendredi mais congés posé ce jours là pour le pont avec le jeudi.
    \tabularnewline
    
    \hline
    46 & 15/11/21 - 21/11/21 & Début de la \gls{POC} \gls{Ansible CMDB} dans le but d'auditer les paquets et leurs versions.
    \tabularnewline
    
    \hline
    47 & 22/11/21 - 28/11/21 & Poursuite des travaux sur \gls{Ansible CMDB}. 
    Travaux sur la configuration de bornes {\gls{Wifi}}. Annulation des travaux pour cause de mauvaises configurations de ma part. 
    Visite médical et réunion de mi-avancement le vendredi.
    \tabularnewline
    
    \hline
\end{tabular}
\caption{Planning du travail effectué sur la période de d'alternance - Partie 1}
\end{table}

\newpage
\begin{table}[!htp]
    \newcolumntype{M}[1]{>{\raggedright}m{#1}}
    \center
    \begin{tabular}{|c|c|M{11.5cm}|}
        
        \hline
        48 & 29/11/21 - 05/12/21 & Fin des travaux sur \gls{Ansible CMDB} et rédaction du \gls{PSSI}.
        \tabularnewline
        
        \hline
        49 & 06/12/21 - 12/12/21 & Avancement sur le {\gls{POC}} Ansible. 
        Mise en place de règles basées sur les facts. 
        Mise au propre du compte rendu et établissement des éléments à auditer.
        \tabularnewline

        \hline
        50 & 13/12/21 - 19/11/21 & Avancement sur le \gls{PSSI}. 
        Réunion de présentation finale de la \gls{POC} \gls{Ansible CMDB}. 
        Nouvelle \gls{POC} sur Rudder pour reproduire une conformité similaire à \gls{Ansible CMDB}.
        \tabularnewline
        
        \hline
        51 & 20/12/21 - 26/12/21 & Semaine complète en entreprise excepté le vendredi pour congé de Noël. 
        Avancement sur le \gls{PSSI}. Présentation bilan moral et financier de l'entreprise sur l'année 2021. 
        Vision sur les objectifs de 2022. Premier ticket client réalisé.
        \tabularnewline
        
        \hline
        52 & 27/12/21 - 02/01/22 & Congés pour Noël.
        \tabularnewline
        
        \hline
        1 & 03/01/22 - 09/01/22 & Poursuite des travaux sur la reprise du \gls{PSSI} pour le faire correspondre au tableau de suivi d'audit. 
        Intervention et découverte du datacenter de Rennes. 
        \tabularnewline
        \hline
        2 & 10/01/22 - 16/02/22 & Avancement sur le \gls{PSSI}, démonstration à un collégien du travail d'administrateur système avec l'installation d'une pile \gls{LAMP}. 
        Préparation de la soutenance de fin de \gls{PFE}.
        \tabularnewline
        
        \hline
        3 & 17/01/22 - 23/01/22 & Soutenance de \gls{PFE}. 
        Pas de journées en entreprise.
        \tabularnewline
        
        \hline
        4 & 24/01/22 - 30/01/22 & Pas de journées en entreprise.
        \tabularnewline   
    \hline
\end{tabular}
\caption{Planning du travail effectué sur la période de d'alternance - Partie 2}
\end{table}


\newpage
\subsection*{Planning détaillé de la période de stage}
\addcontentsline{toc}{subsection}{Planning détaillé de la période de stage}
\begin{table}[!ht]
\newcolumntype{M}[1]{>{\raggedright}m{#1}}
\center
\begin{tabular}{|c|c|M{11.5cm}|}
    \hline
    N° & Semaine & \begin{center}
        Description
    \end{center} 
    \tabularnewline    
    \hline
    9 & 28/02/22 - 06/03/22 & Installation d'un serveur de \gls{CVE}. 
    Ajout de l'import des logiciels à \gls{GLPI}. 
    Configuration d' \gls{OCSInventory} pour prendre en compte les rapports de \gls{CVE}. 
    Configuration de l'ordinateur pour un développeur. 
    Mise en place d'un scan \gls{SNMP} rattaché à \gls{GLPI} et \gls{OCSInventory}. 
    Installation de \gls{NocoDB} avec sauvegarde \gls{SQL} de la base de données de \gls{Redmine}. 
    Reprise de la documentation technique liée aux \gls{datacenters}.
    \tabularnewline
    
    \hline
    10 & 07/03/22 - 13/03/22 & Configuration du serveur \gls{OCSInventory} en \gls{HTTPS} avec un certificat auto-signé pour pouvoir effectuer des scans \gls{SNMP} à partir d'agent spécifique. 
    Modifications du comportement de l'agent vers \gls{HTTPS} avec activation \gls{SSL}. 
    Poursuite des travaux sur la documentation technique et rédaction du rapport de stage. 
    Maintenance d'un ordinateur qui ne boot plus : changements depuis un disque externe pour revenir sur un ancien noyau \gls{Linux} mais problème lié au driver graphique. 
    Installation d'une carte d'extension 10G sur un noeud \gls{Proxmox}. 
    Installation d'un \gls{LimeSurvey} de test en conteneur pour un client. 
    Installation d'un noeud \gls{Proxmox} puis début de configuration d'un \gls{cluster} \gls{Ceph}.
    \tabularnewline
    
    \hline
    11 & 14/03/22 - 20/03/22 & Réunion de lancement d'audit de sécurité avec la société Cogiceo. 
    Poursuite de la configuration du \gls{cluster} \gls{Ceph}, ajout des \gls{OSD}.
    Configuration en pause pour le moment en attendant de faire la conception des pools et storages. 
    Modification des configurations \gls{DHCP} de façon à ce que tout le monde soit sur une adresse \gls{IP} en 22. 
    Reprise de la configuration des règles \gls{GLPI} avant l'ajout de tous les périphériques. 
    Installation de NetData pour vérifier le fonctionnement d'une machine défectueuse. 
    Installation et configuration d'un nouveau noeud \gls{Proxmox} ajouté au \gls{cluster} de test. 
    Fin de paramétrage de \gls{GLPI} avant d'ajouter l'ensemble du matériel du personnel.
    \tabularnewline


\hline
\end{tabular}
\caption{Planning du travail effectué sur la période de stage - Partie 1}
\end{table}

\newpage
\begin{table}[!ht]
\newcolumntype{M}[1]{>{\raggedright}m{#1}}
\center
\begin{tabular}{|c|c|M{11.5cm}|}
    \hline
    N° & Semaine & \begin{center}
        Description
    \end{center} 
    \tabularnewline

    \hline
    13 & 28/03/28 - 03/04/22 & Fin des installations pour l'audit de sécurité avec l'installation de \gls{Passhport}. 
    Lancement de l'installation des agents \gls{OCSInventory} sur l'ensemble des ordinateurs du personnel. 
    Test de l'application \gls{Wazuh} pour du monitoring de sécurité. 
    Préparation de l'environnement local pour l'exécution de scripts \gls{Ansible} en production. 
    Correction du script \gls{Ansible} pour la prise en compte des différences entre \gls{CentOS} 7 et 8, avec spécification pour \gls{Rocky}, \gls{Alma} etc. 
    Ajout de l'agent \gls{OCSInventory} sur toutes les machines du datacenter d'Angers.
    \tabularnewline
    
    \hline
    14 & 04/04/22 - 10/04/22 & Fin de l'installation des agents \gls{OCSInventory} pour les machines du datacenter d'Angers. 
    Début de l'installation des agents pour le datacenter de Tours. Poursuite des travaux sur la documentation. 
    Installation pour un client d'un \gls{Nextcloud}/\gls{Collabora} pour un client sur le datacenter de Rennes via docker-compose.  
    \tabularnewline
    
    \hline
    15 & 11/04/22 - 17/04/22 & Ajout de l'agent \gls{OCSInventory} sur toutes les machines du datacenters de Rennes. 
    Installation et configuration de \gls{Wazuh} pour réaliser un audit automatisés de l'infrastructure.
    \tabularnewline
    
    \hline
    16 & 18/04/22 - 24/04/22 & Intervention au datacenter pour le changement d'un serveur. Poursuite des travaux sur la documentation. 
    Poursuite des travaux avec \gls{Wazuh}. Installation d'un \gls{cluster} \gls{Kubernetes} à 2 noeuds pour pouvoir y faire de la veille technologique. 
    Mise en place du stockage du \gls{cluster} \gls{Kubernetes}. 
    Préparation d'un ordinateur pour un nouvel employé.
    \tabularnewline
    
    \hline
    17 & 25/04/22 - 01/05/22 &  Poursuite de la veille sur \gls{Kubernetes}. Début des travaux pour auditer les ressources des datacenters. 
    L'idée est d'avoir un outil permettant de contrôler que ce qui est vendu au client est bien respecté en matière de ressources.
    \tabularnewline
    
    \hline
    18 & 02/05/22 - 08/05/22 &  Mise à jour de l'inventaire \gls{Ansible} qui avait des défauts dans sa constructions. 
    Modifications de différents problèmes empêchant l'installation des agents \gls{OCSInventory}. 
    Installation d'une nouvelle instance d'un site internet pour réaliser des \gls{webinaire}s.
    \tabularnewline
    
    \hline
\end{tabular}
\caption{Planning du travail effectué sur la période de stage - Partie 2}
\end{table}

\newpage
\begin{table}[!ht]
\newcolumntype{M}[1]{>{\raggedright}m{#1}}
\center
\begin{tabular}{|c|c|M{11.5cm}|}
    \hline
    N° & Semaine & \begin{center}
        Description
    \end{center} 
    \tabularnewline

    \hline
    19 & 09/05/22 - 15/05/22 &  Mise à jours de l'une des instances de \gls{webinaire}. 
    Modification des scripts Perl/Bash pour récupérer les \gls{vhosts} des machines que ce soit pour des vhosts hébergés sous \gls{Docker}/\gls{Nginx} ou \gls{Apache}. 
    Mise en place d'une \gls{plateforme web}\gls{Peertube} pour faire de l'hébergement vidéo et des lives. 
    Installation d'un 2nd \gls{bastion SSH} (\gls{passhport}) destiné à être un slave du 1er afin d'y exécuter des \gls{playbooks} \gls{Ansible} globaux sans impact sur l'utilisation des autres utilisateurs. 
    Création de la 2nd base de données en \gls{Master/Slave} sur \gls{Mariadb}.
    \tabularnewline

    \hline
    20 & 16/05/22 - 22/05/22 & Fin de l'installation du 2nd \gls{bastion SSH} (\gls{passhport}). 
    Ré-exécution des \gls{playbooks} \gls{Ansible} d'installation d'agent \gls{OCSInventory} afin de mettre à jours l'ensemble des \gls{vhosts}. 
    En congé le vendredi 20. Début des mise à jours des instances \gls{BigBlueButton}
    \tabularnewline
    
    \hline
    21 & 23/05/22 - 29/05/22 & Poursuite de la ré-exécution des \gls{playbooks} \gls{Ansible} d'installation d'agent \gls{OCSInventory} afin de mettre à jours l'ensemble des \gls{vhosts}. 
    Poursuite des mise à jours des instances \gls{BigBlueButton}. 
    Congé le lundi 23, jeudi 26 et vendredi 27.
    \tabularnewline
    
    \hline
    22 & 30/05/22 - 05/06/22 & Fin de la ré-exécution des \gls{playbooks} \gls{Ansible} d'installation d'agent \gls{OCSInventory}. 
    Recherche d'une solution sans agent pour faire un état des lieux en matières de sécurité des différentes machines et automatiser la mise en oeuvre de correctif. 
    Les tests s'appliquent à  \gls{OpenSCAP}. 
    Rédaction d'un Plan d'Assurance de Sécurité dans le cadre d'une demande d'un client. 
    Poursuite des travaux sur la documentation du datacenter.
    \tabularnewline
    
    \hline
    23 & 06/06/22 - 12/06/22 & Installation d'une nouvelle instance \gls{Framemo}, sur un nom de domaine publique. 
    Poursuite des travaux sur \gls{OpenSCAP}. 
    Réunion de lancement pour un projet d'infrastructure pour Dehon. 
    Début des travaux sur le projet Dehon avec \gls{Terraform} pour la création des machines virtuelles.
    \tabularnewline
    
    \hline
    24 & 13/06/22 - 19/06/22 & Création des machines virtuelles pour le projet Dehon. 
    Création du \gls{cluster} \gls{Kubernetes} avec \gls{Calico} en \gls{CNI} sur les six précédentes machines virtuelles avec \gls{Kubespray}. 
    Installation d'un ordinateur portable pour un nouvel arrivant. 
    Poursuite des travaux sur \gls{OpenSCAP}.
    \tabularnewline
    \hline
\end{tabular}
\caption{Planning du travail effectué sur la période de stage - Partie 3}
\end{table}

\newpage
\begin{table}[!ht]
\newcolumntype{M}[1]{>{\raggedright}m{#1}}
\center
\begin{tabular}{|c|c|M{11.5cm}|}
    \hline
    N° & Semaine & \begin{center}
        Description
    \end{center} 
    \tabularnewline

    \hline
    25 & 20/06/22 - 26/06/22 & Poursuite des travaux sur \gls{OpenSCAP}. 
    Rédaction d'une documentation utilisateur sur la configuration de l'agenda \gls{Nextcloud} sur téléphone. 
    Début des recherches pour la mise en place d'un outil de scan du réseau. 
    Rédaction du rapport de stage. 
    Intervention aux datacenters de Tours et Cogent. 
    Ticket client pour la configuration d'un agenda \gls{Nextcloud}.
    \tabularnewline

    \hline
    26 & 27/06/22 - 03/07/22 & Recherche et intervention pour les travaux sur \gls{Nextcloud}. 
    Poursuite des travaux sur Dehon avec le lancement des 2 \gls{Haproxy} avec \gls{VIP}. 
    Configuration et test des configurations \gls{Haproxy}. 
    Mise en place sur Dehon des IngressController, CertManager, Namespaces et Rancher rke.
    \tabularnewline

    \hline
    27 & 04/07/22 - 10/07/22 & Mise en place sur Dehon de Rancher rke. 
    Rédaction de la documentation technique du projet Dehon sur le déploiement de l'ensemble du projet. 
    Journée Team Building au lac de Maine avec présentation du bilan du premier semestre de l'entreprise. 
    Mise en place des environnements/namespaces de prod/qualif/test avec \gls{Terraform} en passant l'\gls{API} de Rancher. 
    Installation de la machine de stockage avec \gls{Terraform}. 
    Particularité de devoir ajouter un second disque et donc recréer un module \gls{Terraform}.
    \tabularnewline
    
    \hline
    28 & 11/07/22 - 17/07/22 & Déploiement de la machine Mongo Arbiter sur Rennes. 
    Configuration du service Mongo via \gls{Terraform} pour une application sous Docker. 
    Installation via \gls{Terraform} de trois opérateurs percona pour les environnements de test, qualif et prod. 
    Installation de mongoarbiter via \gls{Ansible}. 
    Congé le vendredi, pont de 4 jours.
    \tabularnewline
    
    \hline
    29 & 18/07/22 - 24/07/22 & Commandes pour les nouveaux arrivants. 
    Création de compte rancher depuis \gls{Terraform}. 
    Déploiement de Loki lié à Grafana en tant que serveur de log pour l'ensemble du \gls{cluster}. 
    Ajout de minio en serveur S3. 
    Ajout de Velero-server pour les backups. 
    Fin de la mise à jours de la documentation pour les nouveaux arrivants. 
    Reprise de la partie backup pour un matomo de la région Normandie.
    \tabularnewline

    \hline
    30 & 25/07/22 - 31/07/22 & Installation d'un \gls{Nextcloud} pour l'association AICLA. 
    Automatisation de l'installation des instances \gls{Nextcloud} via Docker-compose, \gls{Ansible}, AWX et \gls{Terraform}.
    \tabularnewline
    
    \hline
    31 & 01/08/22 - 07/08/22 & Configuration d'un stockage CephFS sur le \gls{Proxmox} d'Angers. 
    Congés maladie pour Covid.
    \tabularnewline

    \hline
    32 & 01/08/22 - 07/08/22 & Rapport de stage et congé jusqu'à la rentrée.
    \tabularnewline
    
    \hline    
\end{tabular}
\caption{Planning du travail effectué sur la période de stage - Partie 4}
\end{table}

\newpage
\subsection*{Bibliographie}
\addcontentsline{toc}{subsection}{Bibliographie}
\nocite{*}
\printbibliography
\newpage
\subsection*{Liste des figures}
\addcontentsline{toc}{subsection}{Liste des figures}
\listoffigures

\newpage
\subsection*{Liste des tables}
\addcontentsline{toc}{subsection}{Liste des tables}
\listoftables

\newpage
\subsection*{Acronymes et définition}
\addcontentsline{toc}{subsection}{Acronymes et définition}
L'ensemble des acronymes et définition du glossaires proviennent de Wikipédia.
\glsaddall
\printglossaries

\end{document}